import{r as e}from"./rolldown-runtime-DGruFWvd.js";import{ot as t}from"./vendor-i_a7m9KR.js";import{_ as n,m as r,p as i,r as a}from"./vendor-charts-uxJ0cBSP.js";import{E as o,d as s,j as c,s as l}from"./vendor-react-B4dzC9y_.js";import{i as u,r as d}from"./index-B6oysRiB.js";import{n as f,r as p,t as m}from"./SuggestionsList-CwoUZ5Di.js";var h=t();function g(){return{score:88,level:`fair`,levelLabel:`Fair`,percentile:85,percentileMessage:`Your rating is lower than 85% of users`,aiTags:[`Excellent deep sleep`,`Time to bed late`,`Normal fragmented sleep`],structureChart:{totalDuration:`7h 11min`,totalMinutes:431,deepDuration:`4h 8min`,deepMinutes:248,segments:[{stage:`light`,start:`23:30`,end:`00:30`},{stage:`deep`,start:`00:30`,end:`02:00`},{stage:`light`,start:`02:00`,end:`03:00`},{stage:`rem`,start:`03:00`,end:`04:00`},{stage:`deep`,start:`04:00`,end:`05:30`},{stage:`light`,start:`05:30`,end:`06:30`},{stage:`awake`,start:`06:30`,end:`06:45`},{stage:`light`,start:`06:45`,end:`07:30`}]},structureAnalysis:[{type:`awake`,label:`Awake`,percent:4,duration:`2 times`,status:`Good`},{type:`rem`,label:`REM`,percent:19,duration:`0 times`,status:`Good`},{type:`light`,label:`Light sleep`,percent:62,duration:`0 times`,status:`Good`},{type:`deep`,label:`Deep sleep`,percent:4,duration:`0 times`,status:`Good`}],qualityIndicators:{bedTime:{value:`20:55`,reference:`22:00`,label:`Bed rest time`},sleepTime:{value:`23:42`,reference:`23:00`,label:`Time to fall asleep`},wakeTime:{value:`07:15`,reference:`7:00`,label:`Post-awake time`},getUpTime:{value:`09:03`,reference:`8:00`,label:`Wake-up time`},sleepLatency:{value:`45`,reference:`<30min`,label:`Falling asleep takes time`,unit:`min`},sleepEfficiency:{value:`85`,reference:`>85%`,label:`Sleep efficiency`,unit:`%`}},aiInsights:[`The average blood oxygen saturation this week was 94.0%, the same as last week.`,`Your blood oxygen level remained at a high level (98%) from Tuesday to Thursday this week.`],suggestions:[{icon:`/images/daily_report/1.webp`,title:`Soaking feet before bed`,description:`Relieve current anxiety and lower heart rate.`},{icon:`/images/daily_report/2.webp`,title:`Today's nap suggestion`,description:`Relieve current anxiety and lower heart rate.`}]}}var _=`sleep_daily_demo_mode`;function v(){try{return localStorage.getItem(_)===`true`}catch(e){return!1}}function y(){try{localStorage.setItem(_,`true`),console.log(`✅ [Sleep Daily Demo Mode] Enabled`)}catch(e){console.error(`[Demo Mode] Failed:`,e)}}function b(){try{localStorage.setItem(_,`false`),console.log(`✅ [Sleep Daily Demo Mode] Disabled`)}catch(e){console.error(`[Demo Mode] Failed:`,e)}}function x(){let e=!v();return e?y():b(),e}var S=c(),C=e=>d[e.toLowerCase()]||`#94a3b8`;const w=(0,h.memo)(({items:e,totalMinutes:t,className:c=``})=>{let{t:l}=o(),u=(0,h.useMemo)(()=>e.map(e=>({name:e.label,value:e.percent,color:C(e.type)})),[e]),d=t?Math.floor(t/60):`--`;return t&&t%60,(0,S.jsxs)(`div`,{className:`bg-white rounded-2xl p-5 shadow-sm ${c}`,children:[(0,S.jsxs)(`div`,{className:`flex items-center gap-2 mb-4`,children:[(0,S.jsx)(`span`,{className:`w-1.5 h-4 rounded-full bg-violet-400`}),(0,S.jsx)(`h3`,{className:`text-base font-semibold text-slate-800`,children:l(`daily.sleepDistribution`,`Sleep distribution`)}),(0,S.jsx)(s,{className:`w-4 h-4 text-slate-400 cursor-pointer`})]}),(0,S.jsxs)(`div`,{className:`flex items-center gap-6`,children:[(0,S.jsx)(`div`,{className:`flex-1 space-y-2`,children:e.map(e=>(0,S.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,S.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,S.jsx)(`span`,{className:`w-2.5 h-2.5 rounded-full`,style:{backgroundColor:C(e.type)}}),(0,S.jsx)(`span`,{className:`text-sm text-slate-600`,children:e.label}),(0,S.jsxs)(`span`,{className:`text-sm font-medium text-slate-800`,children:[e.percent,`%`]})]}),(0,S.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,S.jsx)(`span`,{className:`text-xs text-slate-500`,children:e.duration}),e.status&&(0,S.jsx)(`span`,{className:`text-xs px-2 py-0.5 rounded-full bg-green-100 text-green-600`,children:e.status})]})]},e.type))}),(0,S.jsxs)(`div`,{className:`relative w-32 h-32 flex-shrink-0`,children:[(0,S.jsx)(n,{width:`100%`,height:`100%`,children:(0,S.jsx)(a,{children:(0,S.jsx)(i,{data:u,cx:`50%`,cy:`50%`,innerRadius:50,outerRadius:63,paddingAngle:3,dataKey:`value`,children:u.map((e,t)=>(0,S.jsx)(r,{fill:e.color},`cell-${t}`))})})}),(0,S.jsxs)(`div`,{className:`absolute inset-0 flex flex-col items-center justify-center`,children:[(0,S.jsx)(`span`,{className:`text-2xl font-bold text-slate-800`,children:d}),(0,S.jsx)(`span`,{className:`text-xs text-slate-400`,children:l(`daily.totalHours`,`Total hours`)})]})]})]})]})});var T=({label:e,value:t,unit:n,reference:r})=>(0,S.jsxs)(`div`,{className:`bg-slate-50 rounded-xl p-3`,children:[(0,S.jsx)(`div`,{className:`text-xs text-slate-500 mb-1`,children:e}),(0,S.jsxs)(`div`,{className:`flex items-baseline gap-1`,children:[(0,S.jsx)(`span`,{className:`text-xl font-bold text-slate-800`,children:t==null?`--`:t}),n&&(0,S.jsx)(`span`,{className:`text-sm text-slate-500`,children:n})]}),(0,S.jsxs)(`div`,{className:`flex items-center gap-1 mt-1`,children:[(0,S.jsx)(s,{className:`w-3 h-3 text-slate-400`}),(0,S.jsxs)(`span`,{className:`text-xs text-slate-400`,children:[`Standard: `,r]})]})]});const E=(0,h.memo)(({indicators:e,className:t=``})=>{let{t:n}=o();return(0,S.jsxs)(`div`,{className:`bg-white rounded-2xl p-5 shadow-sm ${t}`,children:[(0,S.jsxs)(`div`,{className:`flex items-center gap-2 mb-4`,children:[(0,S.jsx)(`span`,{className:`w-1.5 h-4 rounded-full bg-violet-400`}),(0,S.jsx)(`h3`,{className:`text-base font-semibold text-slate-800`,children:n(`daily.sleepQuality`,`Sleep quality indicators`)}),(0,S.jsx)(s,{className:`w-4 h-4 text-slate-400 cursor-pointer`})]}),(0,S.jsxs)(`div`,{className:`grid grid-cols-2 gap-3`,children:[(0,S.jsx)(T,{label:e.bedTime.label,value:e.bedTime.value,reference:e.bedTime.reference}),(0,S.jsx)(T,{label:e.sleepTime.label,value:e.sleepTime.value,reference:e.sleepTime.reference}),(0,S.jsx)(T,{label:e.wakeTime.label,value:e.wakeTime.value,reference:e.wakeTime.reference}),(0,S.jsx)(T,{label:e.getUpTime.label,value:e.getUpTime.value,reference:e.getUpTime.reference}),(0,S.jsx)(T,{label:e.sleepLatency.label,value:e.sleepLatency.value,unit:e.sleepLatency.unit,reference:e.sleepLatency.reference}),(0,S.jsx)(T,{label:e.sleepEfficiency.label,value:e.sleepEfficiency.value,unit:e.sleepEfficiency.unit,reference:e.sleepEfficiency.reference})]})]})});var D={deep:`#6366f1`,light:`#a5b4fc`,rem:`#e0e7ff`,awake:`#f97316`},O={paddingTop:20,paddingBottom:30,paddingLeft:60,paddingRight:20,blockHeight:40,baseRadius:12,lineWidth:6,bufferLong:5,bufferShort:1},k=[{key:`awake`,label:`Awake`,order:0},{key:`rem`,label:`REM`,order:1},{key:`light`,label:`Light`,order:2},{key:`deep`,label:`Deep`,order:3}],A=(e,t=new Date(`2024-01-01`))=>{let[n,r]=e.split(`:`).map(Number),i=new Date(t);return i.setHours(n,r,0,0),n<12&&i.setDate(i.getDate()+1),i.getTime()},j=(e,t,n,r,i)=>{let a=O.baseRadius,o={tl:a,tr:a,br:a,bl:a};return r&&t!==null&&(t<e?o.tl=0:t>e&&(o.bl=0)),i&&n!==null&&(n<e?o.tr=0:n>e&&(o.br=0)),o};const M=({data:e,height:t=320,colors:n=d||D,className:r=``})=>{var i;let a=(0,h.useRef)(null),o=(0,h.useRef)(null),[s,c]=(0,h.useState)(null),[l,u]=(0,h.useState)({width:0,height:0}),f=(0,h.useMemo)(()=>{if(!e||e.length===0)return[];let t=new Date(`2024-01-01`),n=[...e].sort((e,n)=>A(e.start,t)-A(n.start,t));return n.map((e,r)=>{var i,a;let o=A(e.start,t),s=A(e.end,t),c=k.find(t=>t.key===e.stage),l=r>0?n[r-1]:null,u=r<n.length-1?n[r+1]:null,d=l?k.find(e=>e.key===l.stage):null,f=u?k.find(e=>e.key===u.stage):null,p=!!(l&&d&&l.stage!==e.stage&&A(l.end,t)===o),m=!!(u&&f&&u.stage!==e.stage&&A(u.start,t)===s),h=j(c.order,(i=d==null?void 0:d.order)==null?null:i,(a=f==null?void 0:f.order)==null?null:a,p,m);return{...e,startTime:o,endTime:s,duration:Math.round((s-o)/1e3/60),stageInfo:c,prevStageInfo:d,prevConnected:p,nextConnected:m,radii:h}})},[e]),p=(0,h.useCallback)(()=>{let e=a.current;if(!e||!f.length)return;let t=e.getContext(`2d`);if(!t)return;let r=window.devicePixelRatio||1,{width:i,height:o}=l;e.width=i*r,e.height=o*r,t.scale(r,r),t.clearRect(0,0,i,o);let s=i-O.paddingLeft-O.paddingRight,c=f[0].startTime,u=f[f.length-1].endTime,d=u-c,p=e=>O.paddingLeft+(e-c)/d*s,m=(o-O.paddingTop-O.paddingBottom)/k.length,h=e=>O.paddingTop+e*m+m/2;t.font=`12px sans-serif`,t.textBaseline=`middle`,k.forEach(e=>{let n=h(e.order);t.fillStyle=`#64748b`,t.textAlign=`right`,t.fillText(e.label,O.paddingLeft-15,n),t.beginPath(),t.strokeStyle=`#e2e8f0`,t.setLineDash([4,4]),t.lineWidth=1,t.moveTo(O.paddingLeft,n),t.lineTo(i-O.paddingRight,n),t.stroke()}),t.setLineDash([]),f.forEach(e=>{if(e.prevConnected&&e.prevStageInfo){let r=p(e.startTime),i=h(e.stageInfo.order),a=h(e.prevStageInfo.order),o=n[e.stage]||n.light,s=n[e.prevStageInfo.key]||n.light,c=Math.abs(i-a),l=O.blockHeight/2;if(c>1){let n=l+(Math.abs(e.stageInfo.order-e.prevStageInfo.order)===1?O.bufferShort:O.bufferLong);n*2>c&&(n=c*.45);let u=i>a,d=Math.min(a,i),f=Math.max(a,i),p=u?s:o,m=u?o:s,h=t.createLinearGradient(0,d,0,f),g=n/c,_=1-g;h.addColorStop(0,p),h.addColorStop(g,p),h.addColorStop(_,m),h.addColorStop(1,m),t.fillStyle=h,t.fillRect(r-O.lineWidth/2,d,O.lineWidth,f-d)}}}),f.forEach(e=>{let r=p(e.startTime),i=p(e.endTime),a=h(e.stageInfo.order),o=Math.max(i-r,1),s=r,c=o,l=O.lineWidth/2;e.prevConnected&&(e.radii.tl===0||e.radii.bl===0)&&(s-=l,c+=l),e.nextConnected&&(e.radii.tr===0||e.radii.br===0)&&(c+=l);let u=a-O.blockHeight/2;t.fillStyle=n[e.stage]||n.light,t.beginPath();let{tl:d,tr:f,br:m,bl:g}=e.radii,_=s,v=u,y=c,b=O.blockHeight;t.moveTo(_+d,v),t.lineTo(_+y-f,v),t.quadraticCurveTo(_+y,v,_+y,v+f),t.lineTo(_+y,v+b-m),t.quadraticCurveTo(_+y,v+b,_+y-m,v+b),t.lineTo(_+g,v+b),t.quadraticCurveTo(_,v+b,_,v+b-g),t.lineTo(_,v+d),t.quadraticCurveTo(_,v,_+d,v),t.closePath(),t.fill()});let g=new Date(c).getHours(),_=new Date(u).getHours()+(new Date(u).getDate()===new Date(c).getDate()?0:24);t.textAlign=`center`,t.fillStyle=`#94a3b8`,t.font=`11px sans-serif`;for(let e=g;e<=_;e++){let n=new Date(c);n.setHours(e,0,0,0),n.getTime()<c&&n.setDate(n.getDate()+1);let r=p(n.getTime());if(r>=O.paddingLeft&&r<=i-O.paddingRight){let n=`${e%24}`.padStart(2,`0`)+`:00`;t.fillText(n,r,o-10),t.beginPath(),t.moveTo(r,o-25),t.lineTo(r,o-20),t.stroke()}}},[l,n,f]);return(0,h.useEffect)(()=>{let e=new ResizeObserver(e=>{let{width:t,height:n}=e[0].contentRect;u({width:t,height:n})});return o.current&&e.observe(o.current),()=>e.disconnect()},[]),(0,h.useEffect)(()=>{p()},[p]),(0,S.jsxs)(`div`,{ref:o,className:`relative w-full ${r}`,style:{height:`${t}px`},children:[(0,S.jsx)(`canvas`,{ref:a,className:`w-full h-full block cursor-crosshair`,onMouseMove:e=>{let t=a.current.getBoundingClientRect(),n=e.clientX-t.left,{width:r}=l,i=r-O.paddingLeft-O.paddingRight;if(i<=0||!f.length)return;if(n<O.paddingLeft||n>r-O.paddingRight){c(null);return}let o=f[0].startTime,s=f[f.length-1].endTime-o,u=o+(n-O.paddingLeft)/i*s,d=f.find(e=>u>=e.startTime&&u<=e.endTime);c(d?{x:e.clientX,y:e.clientY,segment:d,duration:d.duration}:null)},onMouseLeave:()=>c(null)}),s&&(0,S.jsxs)(`div`,{className:`fixed z-50 pointer-events-none bg-white/95 backdrop-blur-sm border border-slate-200 shadow-xl rounded-lg p-3 text-sm`,style:{left:s.x+15,top:s.y+15,transform:`translate(0, 0)`},children:[(0,S.jsx)(`div`,{className:`font-semibold text-slate-800 mb-1`,children:(i=k.find(e=>e.key===s.segment.stage))==null?void 0:i.label}),(0,S.jsxs)(`div`,{className:`text-slate-500 text-xs tabular-nums`,children:[s.segment.start,` - `,s.segment.end]}),(0,S.jsxs)(`div`,{className:`text-slate-500 text-xs mt-1`,children:[`Duration: `,s.duration,` min`]}),(0,S.jsx)(`div`,{className:`absolute left-0 top-3 w-1 h-4 rounded-r`,style:{backgroundColor:n[s.segment.stage]}})]})]})},N=(0,h.memo)(({totalDuration:e,deepDuration:t,segments:n,className:r=``})=>{let{t:i}=o();return(0,S.jsxs)(`div`,{className:`bg-white rounded-2xl p-5 shadow-sm ${r}`,children:[(0,S.jsxs)(`div`,{className:`flex items-center gap-2 mb-4`,children:[(0,S.jsx)(`span`,{className:`w-1.5 h-4 rounded-full bg-violet-400`}),(0,S.jsx)(`h3`,{className:`text-base font-semibold text-slate-800`,children:i(`daily.sleepStructure`,`Sleep structure diagram`)})]}),(0,S.jsxs)(`div`,{className:`flex items-center gap-8 mb-4`,children:[(0,S.jsxs)(`div`,{children:[(0,S.jsx)(`div`,{className:`text-2xl font-bold text-slate-800`,children:e}),(0,S.jsx)(`div`,{className:`text-xs text-slate-400`,children:i(`daily.totalDuration`,`Total sleep duration`)})]}),(0,S.jsxs)(`div`,{children:[(0,S.jsx)(`div`,{className:`text-2xl font-bold text-violet-500`,children:t}),(0,S.jsx)(`div`,{className:`text-xs text-slate-400`,children:i(`daily.deepSleep`,`Deep sleep`)})]})]}),(0,S.jsxs)(`div`,{className:`flex items-center gap-4 mb-3`,children:[(0,S.jsxs)(`div`,{className:`flex items-center gap-1.5`,children:[(0,S.jsx)(`span`,{className:`w-3 h-3 rounded`,style:{backgroundColor:d.deep}}),(0,S.jsx)(`span`,{className:`text-xs text-slate-500`,children:i(`sleep.deep`,`Deep sleep`)})]}),(0,S.jsxs)(`div`,{className:`flex items-center gap-1.5`,children:[(0,S.jsx)(`span`,{className:`w-3 h-3 rounded`,style:{backgroundColor:d.light}}),(0,S.jsx)(`span`,{className:`text-xs text-slate-500`,children:i(`sleep.light`,`Light sleep`)})]}),(0,S.jsxs)(`div`,{className:`flex items-center gap-1.5`,children:[(0,S.jsx)(`span`,{className:`w-3 h-3 rounded`,style:{backgroundColor:d.rem}}),(0,S.jsx)(`span`,{className:`text-xs text-slate-500`,children:i(`sleep.rem`,`REM`)})]}),(0,S.jsxs)(`div`,{className:`flex items-center gap-1.5`,children:[(0,S.jsx)(`span`,{className:`w-3 h-3 rounded`,style:{backgroundColor:d.awake}}),(0,S.jsx)(`span`,{className:`text-xs text-slate-500`,children:i(`sleep.awake`,`Awake`)})]})]}),(0,S.jsx)(M,{data:n,height:240})]})});function P(){let{t:e}=o(),[t,n]=(0,h.useState)(null),[r,i]=(0,h.useState)(v());return(0,h.useEffect)(()=>{n(g())},[r]),t?(0,S.jsx)(`div`,{className:`min-h-screen pb-20`,style:{backgroundColor:`#F1EFEE`},children:(0,S.jsx)(`div`,{className:`max-w-2xl mx-auto`,children:(0,S.jsxs)(`div`,{className:`p-4 space-y-4`,children:[(0,S.jsxs)(`div`,{className:`flex items-center justify-end gap-2`,children:[(0,S.jsx)(`span`,{className:`text-xs text-slate-500`,children:`Demo Mode`}),(0,S.jsx)(`button`,{onClick:()=>{i(x())},className:`w-10 h-5 rounded-full transition-colors ${r?`bg-violet-400`:`bg-slate-300`}`,children:(0,S.jsx)(`span`,{className:`block w-4 h-4 bg-white rounded-full shadow transform transition-transform ${r?`translate-x-5`:`translate-x-0.5`}`})})]}),(0,S.jsx)(p,{score:t.score,maxScore:200,levelLabel:t.levelLabel,percentile:t.percentile,percentileMessage:t.percentileMessage,aiTags:t.aiTags,themeColor:`#A37EFE`,title:e(`daily.todayScore`,`Today's score`),icon:(0,S.jsx)(l,{className:`w-6 h-6 text-white`})}),(0,S.jsx)(N,{totalDuration:t.structureChart.totalDuration,deepDuration:t.structureChart.deepDuration,segments:t.structureChart.segments}),(0,S.jsx)(w,{items:t.structureAnalysis,totalMinutes:t.structureChart.totalMinutes}),(0,S.jsx)(E,{indicators:t.qualityIndicators}),t.aiInsights.length>0&&(0,S.jsx)(f,{insights:t.aiInsights,themeColor:u.sleep}),t.suggestions.length>0&&(0,S.jsx)(m,{suggestions:t.suggestions}),(0,S.jsx)(`p`,{className:`text-xs text-slate-400 text-center px-4 py-2`,children:e(`common.disclaimer`,`The monitoring results of this product are for reference only.`)})]})})}):(0,S.jsx)(`div`,{className:`flex items-center justify-center h-64`,children:`Loading...`})}export{P as default};