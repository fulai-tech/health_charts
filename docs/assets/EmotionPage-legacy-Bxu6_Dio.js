System.register(["./vendor-legacy-BFWz_Ol4.js","./vendor-charts-legacy-T56nRIl-.js","./vendor-router-legacy-dtk8Qgi9.js","./vendor-query-legacy-DmLb6WcG.js","./vendor-i18n-legacy-fjOwBjkb.js","./theme-legacy-BPmhlnTm.js","./card-legacy-BAqfJ-x3.js","./useUrlParams-legacy-DwHop4BH.js","./client-legacy-CFiQjTX9.js","./DistributionCard-legacy-D0GcXimJ.js","./useChartAnimation-legacy-6rVLwxCV.js","./TrendLineChart-legacy-OymNiGz5.js","./WeeklyOverviewCard-legacy-BA9KKe86.js","./usePrefetchData-legacy-IN3Mv77r.js","./DisclaimerBox-legacy-RyuuXYpk.js","./StackedBarChart-legacy-7iHkKllm.js","./DataAnalysisCard-legacy-Bo096RDw.js"],function(e,t){var a,n,s,l,o,i,r,d,c,u,m,g,x,p,h,y,v,f,b,j,w,N,k,D,S,$,C,A,_,F,L,T,M,P,E,K,I,V,R,U,W,B,O,z,q;function H({data:e,className:t}){var a;const{t:n}=g(),s=(null==e||null===(a=e.weeklySummary)||void 0===a?void 0:a.dataAnalysis)||[],l=[n("page.emotion.defaultAnalysis1",{defaultValue:"æ‚¨çš„æƒ…ç»ªä»¥ç§¯æä¸ºä¸»ï¼Œæ•´ä½“çŠ¶æ€è‰¯å¥½"}),n("page.emotion.defaultAnalysis2",{defaultValue:"æƒ…ç»ªæ³¢åŠ¨åœ¨æ­£å¸¸èŒƒå›´å†…ï¼Œæƒ…ç»ªè°ƒèŠ‚èƒ½åŠ›è¾ƒå¼º"}),n("page.emotion.defaultAnalysis3",{defaultValue:"å»ºè®®ç»§ç»­ä¿æŒç§¯æçš„ç”Ÿæ´»æ€åº¦ï¼Œé€‚å½“è¿›è¡Œæ”¾æ¾è®­ç»ƒ"})];return(0,C.jsx)(S,{titleKey:"page.emotion.dataAnalysis",Icon:i,items:s.length>0?s:l,themeColor:x.primary,className:t})}function Y({data:e,className:t}){const{t:a}=g(),n=null==e?void 0:e.weeklySummary;return(0,C.jsx)(j,{titleKey:"page.emotion.weeklyOverview",Icon:r,overallText:(null==n?void 0:n.overview)||a("page.emotion.defaultOverview",{defaultValue:"æœ¬å‘¨æ‚¨çš„æƒ…ç»ªæ•´ä½“å¤„äºç§¯æçŠ¶æ€ã€‚ç»§ç»­ä¿æŒè‰¯å¥½çš„å¿ƒæ€å’Œç”Ÿæ´»ä¹ æƒ¯ï¼"}),highlightText:(null==n?void 0:n.highlights)||a("page.emotion.defaultHighlights",{defaultValue:"è¶‹åŠ¿å›¾æ˜¾ç¤ºæ‚¨çš„æƒ…ç»ªåœ¨æœ¬å‘¨ä¸­æœ‰ä¸€äº›æ³¢åŠ¨ã€‚è¿™æ˜¯æ­£å¸¸çš„ï¼Œå¯èƒ½ä¼šå—åˆ°å·¥ä½œå‹åŠ›ã€ç¡çœ è´¨é‡å’Œç¤¾äº¤æ´»åŠ¨çš„å½±å“ã€‚"}),highlightLabelKey:"page.emotion.needsAttention",highlightColor:"#FBBF24",suggestions:null==n?void 0:n.suggestions,themeColor:x.primary,className:t})}function X(){try{return"true"===localStorage.getItem(O)}catch(e){return console.warn("[Emotion Demo Mode] Failed to read from localStorage:",e),!1}}function G(){const e=!X();return e?function(){try{localStorage.setItem(O,"true"),console.log("âœ… [Emotion Demo Mode] Enabled - Using dummy data")}catch(e){console.error("[Emotion Demo Mode] Failed to enable:",e)}}():function(){try{localStorage.setItem(O,"false"),console.log("âœ… [Emotion Demo Mode] Disabled - Using backend data")}catch(e){console.error("[Emotion Demo Mode] Failed to disable:",e)}}(),e}function J({className:e="",onChange:t}){const{t:a}=g(),[n,s]=(0,$.useState)(X);return(0,$.useEffect)(()=>{s(X())},[]),(0,C.jsxs)("div",{className:`flex items-center gap-3 ${e}`,children:[(0,C.jsx)("span",{className:"text-sm font-medium text-slate-700",children:a("page.emotion.demoMode","Demo Mode")}),(0,C.jsx)("button",{onClick:()=>{const e=G();s(e),null==t||t(e),window.location.reload()},className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 "+(n?"bg-purple-500":"bg-slate-300"),role:"switch","aria-checked":n,"aria-label":a("page.emotion.toggleDemoMode","Toggle demo mode"),children:(0,C.jsx)("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform "+(n?"translate-x-6":"translate-x-1")})}),(0,C.jsx)("span",{className:"text-xs text-slate-500",children:n?a("page.emotion.demoModeOn","Using dummy data"):a("page.emotion.demoModeOff","Using backend data")})]})}function Q(e){const t=new Date(e);return`${String(t.getMonth()+1).padStart(2,"0")}/${String(t.getDate()).padStart(2,"0")}`}function Z(){const e=new Date,t=[],a=[],n=[78,82,75,88,85,90,86],s=[25,30,20,35,32,40,38],l=[55,50,60,45,48,42,44],o=[20,20,20,20,20,18,18];for(let i=6;i>=0;i--){const r=new Date(e);r.setDate(r.getDate()-i);const d=r.getDay(),c=["weekdays.sun","weekdays.mon","weekdays.tue","weekdays.wed","weekdays.thu","weekdays.fri","weekdays.sat"],u=6-i;t.push({date:r,dateLabel:Q(r.toISOString().split("T")[0]),weekdayKey:c[d],score:n[u]}),a.push({date:r,dateLabel:Q(r.toISOString().split("T")[0]),weekdayKey:c[d],positivePercent:s[u],neutralPercent:l[u],negativePercent:o[u],positiveCount:Math.round(s[u]/5),neutralCount:Math.round(l[u]/5),negativeCount:Math.round(o[u]/5)})}return{trendChartData:t,yAxisRange:{min:0,max:100},compositionData:a,summary:{avgValue:85,previousAvg:86,maxValue:88,maxWeekdayKey:"weekdays.tue",minValue:82,minWeekdayKey:"weekdays.mon",emotionLevel:"good",emotionLabel:"ç§¯æå‘å¥½",trend:"dn",changeValue:1},distribution:{totalCount:55,dominantEmotion:"å¹³é™",distribution:[{type:"happy",label:"å¼€å¿ƒ",count:4,percent:7},{type:"angry",label:"ç”Ÿæ°”",count:5,percent:9},{type:"neutral",label:"å¹³é™",count:45,percent:82},{type:"surprised",label:"åº†å¹¸",count:0,percent:0},{type:"sad",label:"æ‚²ä¼¤",count:1,percent:2},{type:"fearful",label:"ææƒ§",count:0,percent:0},{type:"disgusted",label:"åŒæ¶",count:0,percent:0}]},comparison:{current:{average:85},previous:{average:86},insight:null},weeklySummary:{overview:'æœ¬å‘¨"å¼€å¿ƒ"ä¸"å¹³é™"å æ¯”åˆè®¡è¾¾ 72%ã€‚å‘¨å…­çš„æˆ·å¤–æ´»åŠ¨æ˜¾è‘—æå‡äº†æ‚¨çš„æ„‰æ‚¦æŒ‡æ•°ã€‚',highlights:'å‘¨äºŒå‡ºç°çŸ­æš‚çš„"ç–²æƒ«/æ‚²ä¼¤"æƒ…ç»ªï¼Œä¸»è¦ä¸å·¥ä½œå‹åŠ›åŠå‰ä¸€æ™šç¡çœ ä¸è¶³æœ‰å…³ã€‚',suggestions:[],dataAnalysis:["æ‚¨çš„æƒ…ç»ªä»¥ç§¯æä¸ºä¸»ï¼Œæ•´ä½“çŠ¶æ€è‰¯å¥½","æƒ…ç»ªæ³¢åŠ¨åœ¨æ­£å¸¸èŒƒå›´å†…ï¼Œæƒ…ç»ªè°ƒèŠ‚èƒ½åŠ›è¾ƒå¼º","å»ºè®®ç»§ç»­ä¿æŒç§¯æçš„ç”Ÿæ´»æ€åº¦ï¼Œé€‚å½“è¿›è¡Œæ”¾æ¾è®­ç»ƒ"]},diaries:[{diaryId:"dummy-1",title:"é’±åŒ…å¤±è€Œå¤å¾—",weekLabel:"å‘¨å›› Thu",dateLabel:"Nov.21",timeLabel:"20:22",content:"ä»Šå¤©å‡ºé—¨ä¹°èœæ—¶ä¸å°å¿ƒæŠŠé’±åŒ…è½åœ¨äº†è¶…å¸‚ï¼Œå›å®¶æ‰å‘ç°ã€‚æ­£ç€æ€¥çš„æ—¶å€™ï¼Œè¶…å¸‚æ‰“æ¥ç”µè¯è¯´æœ‰äººæ¡åˆ°äº¤ç»™äº†æœåŠ¡å°ã€‚çœŸæ˜¯å¤ªæ„Ÿè°¢é‚£ä½å¥½å¿ƒäººäº†ï¼Œä¸–ç•Œè¿˜æ˜¯å¥½äººå¤šå•Šï¼",emotionTags:["åº†å¹¸"],imageUrl:"/images/emotion/wallet.png"},{diaryId:"dummy-2",title:"ç¤¾åŒºæ´»åŠ¨çœŸçƒ­é—¹",weekLabel:"å‘¨äº” Fri",dateLabel:"Nov.22",timeLabel:"15:30",content:"ä»Šå¤©å‚åŠ äº†ç¤¾åŒºç»„ç»‡çš„è€å¹´äººè”è°Šä¼šï¼Œè§åˆ°äº†å¥½å¤šè€æœ‹å‹ã€‚å¤§å®¶ä¸€èµ·èŠå¤©ã€ä¸‹æ£‹ã€å”±æ­Œï¼Œåº¦è¿‡äº†æ„‰å¿«çš„ä¸‹åˆã€‚æ´»åŠ¨ç»“æŸåè¿˜ä¸€èµ·åˆå½±ç•™å¿µï¼ŒçœŸå¸Œæœ›è¿™æ ·çš„æ´»åŠ¨èƒ½å¤šä¸¾åŠå‡ æ¬¡ã€‚",emotionTags:["å¼€å¿ƒ"],imageUrl:"/images/emotion/meeting.png"},{diaryId:"dummy-3",title:"æœŸå¾…å·²ä¹…çš„å®¶åº­èšé¤",weekLabel:"å‘¨ä¸€ Mon",dateLabel:"Nov.24",timeLabel:"19:33",content:"ä»Šå¤©å­©å­ä»¬éƒ½å›æ¥äº†ï¼Œæˆ‘ç‰¹æ„åšäº†ä»–ä»¬çˆ±åƒçš„çº¢çƒ§è‚‰ã€‚å°å­™å­è®²äº†å¾ˆå¤šå­¦æ ¡çš„äº‹æƒ…ï¼Œå¥³å„¿ä¹Ÿåˆ†äº«äº†å·¥ä½œä¸Šçš„è¶£äº‹ã€‚ä¸€å®¶äººå›´ååœ¨ä¸€èµ·åƒé¥­èŠå¤©ï¼Œè¿™ç§æ¸©é¦¨çš„æ„Ÿè§‰çœŸå¥½ã€‚",emotionTags:["å¼€å¿ƒ"],imageUrl:"/images/emotion/daughter.png"}]}}function ee(e){var t,a,n,s,l;if(console.log("[Emotion Adapter] Input:",e),!e)return console.warn("[Emotion Adapter] No API data, using dummy data"),Z();const o=((null==e||null===(t=e.trend_chart)||void 0===t?void 0:t.chart_data)||[]).map(e=>({date:new Date(e.date),dateLabel:Q(e.date),weekdayKey:z[e.label]||"weekdays.mon",score:e.score})),i=((null==e||null===(a=e.emotion_composition)||void 0===a?void 0:a.chart_data)||[]).map(e=>({date:new Date(e.date),dateLabel:Q(e.date),weekdayKey:z[e.label]||"weekdays.mon",positivePercent:e.positive_percent,neutralPercent:e.neutral_percent,negativePercent:e.negative_percent,positiveCount:e.positive_count,neutralCount:e.neutral_count,negativeCount:e.negative_count})),r=((null==e?void 0:e.emotion_diaries)||[]).map(e=>({diaryId:e.diary_id,title:e.title,weekLabel:e.week_label,dateLabel:e.date_label,timeLabel:e.time_label,content:e.content,emotionTags:e.emotion_tag||[],imageUrl:e.image_url})),d=(null==e?void 0:e.overview)||{},c=d.average||0,u=d.previous_average||0,m=d.max||0,g=d.min||0,x=d.max_label&&z[d.max_label]||"weekdays.mon",p=d.min_label&&z[d.min_label]||"weekdays.mon",h="good"===(y=d.emotion_level)||"neutral"===y||"bad"===y?y:"neutral";var y;const v=d.emotion_label||"",f=d.change||{},b=function(e){return"up"===e||"dn"===e||"same"===e?e:"same"}(f.trend),j=f.value||0,w=(null==e?void 0:e.emotion_distribution)||{},N={totalCount:w.total_count||0,dominantEmotion:w.dominant_emotion||"",distribution:(w.distribution||[]).map(e=>({type:e.type,label:e.label,count:e.count,percent:e.percent}))},k=(null==e?void 0:e.comparison)||{},D=(null==e?void 0:e.weekly_summary)||{},S={trendChartData:o.length>0?o:Z().trendChartData,yAxisRange:(null==e||null===(n=e.trend_chart)||void 0===n?void 0:n.y_axis_range)||{min:0,max:100},compositionData:i.length>0?i:Z().compositionData,summary:{avgValue:c,previousAvg:u,maxValue:m,maxWeekdayKey:x,minValue:g,minWeekdayKey:p,emotionLevel:h,emotionLabel:v,trend:b,changeValue:j},distribution:N,comparison:{current:{average:(null===(s=k.current)||void 0===s?void 0:s.average)||c},previous:{average:(null===(l=k.previous)||void 0===l?void 0:l.average)||u},insight:k.insight||null},weeklySummary:{overview:D.overview||null,highlights:D.highlights||null,suggestions:D.suggestions||[],dataAnalysis:D.data_analysis||[]},diaries:r.length>0?r:Z().diaries};return console.log("[Emotion Adapter] Output:",S),S}async function te(e){try{return await w("emotion",e)}catch(t){return console.warn("[Emotion API] API not available, using dummy data:",t),null}}function ae(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function ne(e){return`${e.getFullYear()}/${String(e.getMonth()+1).padStart(2,"0")}/${String(e.getDate()).padStart(2,"0")}`}return e("EmotionPage",function(){const{t:e}=g(),{theme:t}=v(),{prefetchPreviousWeeks:a}=function(){const e=X();return N({featureName:"Emotion",queryKeyFn:t=>q.trend(t,e),fetchFn:async t=>{if(e)return Z();try{return ee(await te({start_date:t.startDate,end_date:t.endDate}))}catch(a){return Z()}}})}(),[n,s]=(0,$.useState)(()=>{const e=new Date,t=new Date;return t.setDate(e.getDate()-6),{start:t,end:e}});(0,$.useEffect)(()=>{a(n.end,3)},[n.end,a]);const l=(0,$.useMemo)(()=>{const e=new Date;e.setHours(0,0,0,0);const t=new Date(n.end);return t.setHours(0,0,0,0),t<e},[n.end]),o=(0,$.useMemo)(()=>({startDate:ae(n.start),endDate:ae(n.end)}),[n]),i=(0,$.useMemo)(()=>({start:ne(n.start),end:ne(n.end)}),[n]),{data:r,isLoading:d,isFetching:c,error:u}=function(e){const t=X();return m({queryKey:q.trend(e,t),queryFn:async()=>{if(t)return console.log("ğŸ­ [Emotion Demo Mode] Using dummy data instead of backend API"),Z();console.log("[Emotion API] Fetching with dateRange:",e);const a=await te(e?{start_date:e.startDate,end_date:e.endDate}:void 0);return console.log("[Emotion API] Result:",a),ee(a)},staleTime:3e5,gcTime:6e5})}(o);return u?(0,C.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4",style:{backgroundColor:t.background},children:(0,C.jsxs)("div",{className:"text-center",children:[(0,C.jsx)("p",{className:"text-red-500 mb-2",children:e("common.error")}),(0,C.jsx)("p",{className:"text-sm",style:{color:t.textSecondary},children:String(u)})]})}):(0,C.jsx)("div",{className:"min-h-screen pb-20",style:{backgroundColor:t.background},children:(0,C.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,C.jsxs)("div",{className:"sticky top-0 z-20 py-3 px-4",style:{backgroundColor:t.background},children:[(0,C.jsx)("div",{className:"flex justify-center",children:(0,C.jsx)(y,{startDate:i.start,endDate:i.end,onPrevious:()=>{s(e=>{const t=new Date(e.start),a=new Date(e.end);return t.setDate(t.getDate()-7),a.setDate(a.getDate()-7),{start:t,end:a}})},onNext:()=>{l&&s(e=>{const t=new Date(e.start),a=new Date(e.end);t.setDate(t.getDate()+7),a.setDate(a.getDate()+7);const n=new Date;return a>n&&(a.setTime(n.getTime()),t.setTime(n.getTime()),t.setDate(t.getDate()-6)),{start:t,end:a}})},disableNext:!l})}),(0,C.jsx)("div",{className:"flex justify-center mt-3",children:(0,C.jsx)(J,{})})]}),(0,C.jsx)("div",{className:"px-4 space-y-4",children:r||d?(0,C.jsxs)("div",{className:"space-y-4",children:[(0,C.jsx)(L,{data:r}),(0,C.jsx)(P,{data:r}),(0,C.jsx)(I,{data:r}),(0,C.jsx)(H,{data:r}),(0,C.jsx)(Y,{data:r}),(0,C.jsx)(B,{data:r}),(0,C.jsx)(k,{})]}):(0,C.jsx)("div",{className:"text-center py-12",children:(0,C.jsx)("p",{className:"text-slate-500",children:e("common.noData")})})})]})})}),{setters:[function(e){a=e.C,n=e.E,s=e.S,l=e.T,o=e.at,i=e.g,r=e.h,d=e.r,c=e.rt,u=e.w},function(e){},function(e){},function(e){m=e.t},function(e){g=e.n},function(e){x=e.n,p=e.s},function(e){h=e.t},function(e){y=e.n,v=e.t},function(e){},function(e){f=e.t},function(e){},function(e){b=e.t},function(e){j=e.t},function(e){w=e.a,N=e.t},function(e){k=e.t},function(e){D=e.t},function(e){S=e.t}],execute:function(){$=o(),C=c(),(A=(0,$.memo)(({level:e,size:t=48,className:a=""})=>{const n=t/48,s=14*n,l=8*n,o=18*n,i=10*n,r=3*n,d=18*n,c=12*n,u=14*n,m="good"===e||"bad"===e?16*n:12*n,g="good"===e||"bad"===e?8*n:2*n;return(0,C.jsxs)("div",{className:`relative rounded-full flex items-center justify-center ${a}`,style:{width:`${t}px`,height:`${t}px`,background:"#FFFFFF",boxShadow:`0 0 0 ${1*n}px rgba(0, 0, 0, 0.06), 0 ${2*n}px ${10*n}px rgba(15, 23, 42, 0.06)`},children:[(0,C.jsx)("div",{className:"absolute rounded-full pointer-events-none",style:{width:1.9*t+"px",height:1.9*t+"px",background:"radial-gradient(circle at 30% 35%, rgba(255, 168, 90, 0.95) 0%, rgba(255, 168, 90, 0.0) 55%), radial-gradient(circle at 65% 70%, rgba(255, 120, 200, 0.85) 0%, rgba(255, 120, 200, 0.0) 60%)",filter:`blur(${22*n}px)`,opacity:.55,zIndex:-1,top:"50%",left:"50%",transform:"translate(-50%, -50%)"}}),(0,C.jsx)("div",{className:"absolute flex items-center justify-center",style:{top:`${"good"===e?o:d}px`,left:"50%",transform:"translateX(-50%)",gap:`${"good"===e?i:c}px`},children:"good"===e?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:{width:`${s}px`,height:`${l}px`,borderTop:3*n+"px solid #F59E0B",borderRadius:`${s/2}px ${s/2}px 0 0`,background:"transparent"}}),(0,C.jsx)("div",{style:{width:`${s}px`,height:`${l}px`,borderTop:3*n+"px solid #F59E0B",borderRadius:`${s/2}px ${s/2}px 0 0`,background:"transparent"}})]}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{className:"rounded-full",style:{width:`${r}px`,height:`${r}px`,background:"#FFA500"}}),(0,C.jsx)("div",{className:"rounded-full",style:{width:`${r}px`,height:`${r}px`,background:"#FFA500"}})]})}),(0,C.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2",style:{bottom:`${u}px`},children:"good"===e?null:"bad"===e?(0,C.jsx)("div",{style:{width:`${m}px`,height:`${g}px`,borderTop:2*n+"px solid #94A3B8",borderRadius:`${m/2}px ${m/2}px 0 0`,transform:`translateY(${4*n}px)`}}):(0,C.jsx)("div",{className:"rounded-full",style:{width:`${m}px`,height:`${g}px`,background:"#94A3B8"}})})]})})).displayName="EmotionFaceIcon",_=(0,$.memo)(({active:e,payload:t})=>{var a;const{t:n}=g();if(!e||!t||0===t.length)return null;const s=null===(a=t[0])||void 0===a?void 0:a.payload;return s&&null!==s.score?(0,C.jsxs)("div",{className:"bg-slate-700 text-white px-3 py-2 rounded-lg text-sm shadow-lg",children:[(0,C.jsx)("p",{className:"font-medium mb-1",children:n(s.weekdayKey)}),(0,C.jsxs)("p",{style:{color:x.primary},children:[n("page.emotion.score"),": ",s.score]})]}):null}),F=({data:e,className:t,isLoading:a})=>{var s,o,i,r,c,u,m,y,v,f,j,w;const{t:N}=g(),k=(0,$.useMemo)(()=>{var t,a;return null!==(t=null==e||null===(a=e.trendChartData)||void 0===a?void 0:a.map((e,t)=>({name:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t%7],weekdayKey:e.weekdayKey,score:e.score})))&&void 0!==t?t:[]},[null==e?void 0:e.trendChartData]);return(0,C.jsxs)(h,{className:`${t} relative overflow-hidden`,children:[(0,C.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,C.jsx)(d,{className:"w-5 h-5",style:{color:x.primary}}),(0,C.jsx)("h3",{className:"text-base font-semibold text-slate-800",children:N("page.emotion.trendyReport")})]}),(0,C.jsxs)("div",{className:"rounded-xl px-5 py-4 mb-4 mx-1",style:{backgroundColor:p.background.warning},children:[(0,C.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,C.jsxs)("div",{children:[(0,C.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:N("page.emotion.weeksAverage")}),(0,C.jsxs)("div",{className:"flex items-baseline gap-1.5",children:[(0,C.jsx)("span",{className:"text-3xl font-bold",style:{color:x.primary},children:null!==(s=null==e||null===(o=e.summary)||void 0===o?void 0:o.avgValue)&&void 0!==s?s:"--"}),(0,C.jsx)("span",{className:"text-lg text-slate-500",children:N("page.emotion.points")}),(()=>{if(!e)return null;const{trend:t,changeValue:a}=e.summary;if(0===a)return null;const s="up"===t;return(0,C.jsxs)("span",{className:"flex items-center gap-0.5 text-sm",style:{color:s?"#10B981":"#EF4444"},children:[(0,C.jsx)(s?l:n,{className:"w-3 h-3"}),Math.abs(a)]})})()]}),(0,C.jsxs)("p",{className:"text-xs text-slate-400 mt-0.5",children:[N("time.lastWeek"),": ",null!==(i=null==e||null===(r=e.summary)||void 0===r?void 0:r.previousAvg)&&void 0!==i?i:"--"," ",N("page.emotion.points")]})]}),(()=>{var t,a;const n=(null==e||null===(t=e.summary)||void 0===t?void 0:t.emotionLevel)||"neutral",s=(null==e||null===(a=e.summary)||void 0===a?void 0:a.emotionLabel)||"--";return(0,C.jsxs)("div",{className:"flex flex-col items-center gap-1.5",children:[(0,C.jsx)(A,{level:n,size:48}),(0,C.jsx)("span",{className:"text-[10px] font-medium text-slate-500 whitespace-nowrap",children:s})]})})()]}),(0,C.jsxs)("div",{className:"flex gap-6",children:[(0,C.jsxs)("div",{children:[(0,C.jsxs)("span",{className:"text-xs text-slate-400",children:[N("common.max"),"(",e?N(e.summary.maxWeekdayKey):"--",")"]}),(0,C.jsxs)("p",{className:"text-xl font-semibold",style:{color:x.primary},children:[null!==(c=null==e||null===(u=e.summary)||void 0===u?void 0:u.maxValue)&&void 0!==c?c:"--"," ",(0,C.jsx)("span",{className:"text-sm font-normal",children:N("page.emotion.points")})]})]}),(0,C.jsxs)("div",{children:[(0,C.jsxs)("span",{className:"text-xs text-slate-400",children:[N("common.min"),"(",e?N(e.summary.minWeekdayKey):"--",")"]}),(0,C.jsxs)("p",{className:"text-xl font-semibold text-slate-600",children:[null!==(m=null==e||null===(y=e.summary)||void 0===y?void 0:y.minValue)&&void 0!==m?m:"--"," ",(0,C.jsx)("span",{className:"text-sm font-normal",children:N("page.emotion.points")})]})]})]})]}),(0,C.jsx)(b,{data:k,lines:[{dataKey:"score",color:x.primary,label:N("page.emotion.score"),showArea:!0,gradientId:"emotionLineGradient",legendShape:"circle"}],xAxisKey:"name",yAxisDomain:[null!==(v=null==e||null===(f=e.yAxisRange)||void 0===f?void 0:f.min)&&void 0!==v?v:0,null!==(j=null==e||null===(w=e.yAxisRange)||void 0===w?void 0:w.max)&&void 0!==j?j:100],renderTooltip:e=>(0,C.jsx)(_,{...e}),showLegend:!1,height:224})]})},L=(0,$.memo)(F),T=(0,$.memo)(({active:e,payload:t})=>{var a;const{t:n}=g();if(!e||!t||0===t.length)return null;const s=null===(a=t[0])||void 0===a?void 0:a.payload;return s?(0,C.jsxs)("div",{className:"bg-slate-700 text-white px-3 py-2 rounded-lg text-sm shadow-lg",children:[(0,C.jsx)("p",{className:"font-medium mb-1",children:n(s.weekdayKey)}),(0,C.jsxs)("p",{style:{color:x.positive},children:[n("page.emotion.positive"),": ",s.positivePercent,"%"]}),(0,C.jsxs)("p",{style:{color:x.neutral},children:[n("page.emotion.neutral"),": ",s.neutralPercent,"%"]}),(0,C.jsxs)("p",{style:{color:x.negative},children:[n("page.emotion.negative"),": ",s.negativePercent,"%"]})]}):null}),M=({data:e,className:t,isLoading:n})=>{const{t:s}=g(),l=(0,$.useMemo)(()=>{var t,a;return null!==(t=null==e||null===(a=e.compositionData)||void 0===a?void 0:a.map((e,t)=>({name:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t%7],weekdayKey:e.weekdayKey,positivePercent:e.positivePercent,neutralPercent:e.neutralPercent,negativePercent:e.negativePercent})))&&void 0!==t?t:[]},[null==e?void 0:e.compositionData]),o=[{dataKey:"positivePercent",color:x.positive,label:s("page.emotion.positive")},{dataKey:"neutralPercent",color:x.neutral,label:s("page.emotion.neutral")},{dataKey:"negativePercent",color:x.negative,label:s("page.emotion.negative")}];return(0,C.jsxs)(h,{className:`${t} relative overflow-hidden`,children:[(0,C.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,C.jsx)(a,{className:"w-5 h-5",style:{color:x.primary}}),(0,C.jsx)("h3",{className:"text-base font-semibold text-slate-800",children:s("page.emotion.statistics")})]}),(0,C.jsx)(D,{data:l,layers:o,xAxisKey:"name",yAxisDomain:[0,100],yAxisFormatter:e=>`${e}%`,legendShape:"square",renderTooltip:e=>(0,C.jsx)(T,{...e}),stackId:"emotion",height:224})]})},P=(0,$.memo)(M),E={happy:x.happy,surprised:x.surprised,calm:x.calm,sad:x.sad,angry:x.angry,fearful:x.fearful,disgusted:x.disgusted,neutral:x.calm},K=({data:e,className:t,isLoading:a})=>{var n,l,o,i;const{t:r}=g(),d=x.primary,c=null!==(n=null==e||null===(l=e.distribution)||void 0===l?void 0:l.distribution)&&void 0!==n?n:[],u=null!==(o=null==e||null===(i=e.distribution)||void 0===i?void 0:i.dominantEmotion)&&void 0!==o?o:"",m=(0,$.useMemo)(()=>c.map(e=>({type:e.type,label:e.label,percent:e.percent,count:e.count,color:E[e.type]||x.calm})),[c]);return(0,C.jsx)(f,{title:r("page.emotion.distribution"),icon:s,themeColor:d,pieChartSize:"medium",items:m,centerValue:u||r("page.emotion.neutral"),centerLabel:"as main",showCount:!1,columns:2,className:t})},I=(0,$.memo)(K),V={"å¼€å¿ƒ":x.happy,"ç”Ÿæ°”":x.angry,"å¹³é™":x.calm,"åº†å¹¸":x.surprised,"æ‚²ä¼¤":x.sad,"ææƒ§":x.fearful,"åŒæ¶":x.disgusted,Happy:x.happy,Angry:x.angry,Calm:x.calm,Surprised:x.surprised,Sad:x.sad,Fearful:x.fearful,Disgusted:x.disgusted},R=(0,$.memo)(({diary:e})=>(0,C.jsx)("div",{className:"w-full flex-shrink-0 px-1",children:(0,C.jsxs)("div",{className:"bg-slate-50 rounded-2xl p-4 relative overflow-hidden",children:[(0,C.jsxs)("div",{className:"mb-3",children:[(0,C.jsx)("h4",{className:"text-base font-semibold text-slate-800 mb-1",children:e.title}),(0,C.jsxs)("div",{className:"text-xs text-slate-400",children:[e.dateLabel," ",e.weekLabel," ",e.timeLabel]})]}),(0,C.jsx)("p",{className:"text-sm text-slate-600 leading-relaxed mb-4",children:e.content}),e.imageUrl&&(0,C.jsx)("div",{className:"mb-4 -mx-4 px-4",children:(0,C.jsx)("div",{className:"rounded-xl overflow-hidden",children:(0,C.jsx)("img",{src:e.imageUrl,alt:e.title,className:"w-full h-auto max-h-64 object-contain",style:{backgroundColor:"transparent"},onError:e=>{e.currentTarget.style.display="none"}})})}),(0,C.jsx)("div",{className:"flex flex-wrap gap-2",children:e.emotionTags.map((e,t)=>(0,C.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs text-white font-medium",style:{backgroundColor:V[e]||x.calm},children:["# ",e]},t))}),(0,C.jsx)("div",{className:"absolute bottom-0 right-0 w-12 h-12",style:{background:"linear-gradient(135deg, transparent 50%, rgba(148, 163, 184, 0.15) 50%)"}})]})})),U=(0,$.memo)(({total:e,current:t,onSelect:a})=>e<=1?null:(0,C.jsx)("div",{className:"flex justify-center items-center gap-2 mt-4",children:Array.from({length:e}).map((e,n)=>(0,C.jsx)("button",{onClick:()=>a(n),className:"transition-all duration-300",style:{width:n===t?24:8,height:8,borderRadius:4,backgroundColor:n===t?"#FB923D":"#D1D5DB"},"aria-label":`Go to slide ${n+1}`},n))})),W=({data:e,className:t,isLoading:a})=>{var n,s;const{t:l}=g(),[o,i]=(0,$.useState)(0),r=(0,$.useRef)(null),d=(0,$.useRef)(0),c=(0,$.useRef)(0),m=(0,$.useRef)(0),p=(0,$.useRef)(!1),[y,v]=(0,$.useState)(0),f=null!==(n=null==e?void 0:e.diaries)&&void 0!==n?n:[];(0,$.useEffect)(()=>{i(0)},[f.length]);const b=(0,$.useCallback)(e=>{d.current=e.touches[0].clientX,c.current=e.touches[0].clientY,p.current=!1,v(0)},[]),j=(0,$.useCallback)(e=>{const t=e.touches[0].clientX,a=e.touches[0].clientY,n=t-d.current,s=a-c.current;if(Math.abs(n)>Math.abs(s)&&Math.abs(n)>10){p.current=!0,e.preventDefault();let t=n;(0===o&&n>0||o===f.length-1&&n<0)&&(t=.3*n),v(t)}m.current=t},[o,f.length]),w=(0,$.useCallback)(()=>{const e=m.current-d.current;p.current&&(e>50&&o>0?i(e=>e-1):e<-50&&o<f.length-1&&i(e=>e+1)),v(0),p.current=!1,d.current=0,m.current=0},[o,f.length]),N=(0,$.useCallback)(e=>{i(e)},[]),k=(null===(s=r.current)||void 0===s||s.offsetWidth,100*-o);return(0,C.jsxs)(h,{className:`${t} relative overflow-hidden`,children:[(0,C.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,C.jsx)(u,{className:"w-5 h-5",style:{color:x.primary}}),(0,C.jsx)("h3",{className:"text-base font-semibold text-slate-800",children:l("page.emotion.diary")})]}),f.length>0?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{ref:r,className:"relative overflow-hidden touch-pan-y",onTouchStart:b,onTouchMove:j,onTouchEnd:w,style:{touchAction:"pan-y pinch-zoom"},children:(0,C.jsx)("div",{className:"flex",style:{transform:`translateX(calc(${k}% + ${y}px))`,transition:0===y?"transform 0.3s ease-out":"none"},children:f.map(e=>(0,C.jsx)(R,{diary:e},e.diaryId))})}),(0,C.jsx)(U,{total:f.length,current:o,onSelect:N})]}):(0,C.jsx)("div",{className:"text-center py-8 text-slate-400 text-sm",children:l("common.noData")})]})},B=(0,$.memo)(W),O="emotion_demo_mode",z={"å‘¨ä¸€":"weekdays.mon","å‘¨äºŒ":"weekdays.tue","å‘¨ä¸‰":"weekdays.wed","å‘¨å››":"weekdays.thu","å‘¨äº”":"weekdays.fri","å‘¨å…­":"weekdays.sat","å‘¨æ—¥":"weekdays.sun"},q={all:["emotion"],trend:(e,t)=>[...q.all,"trend",null==e?void 0:e.startDate,null==e?void 0:e.endDate,t?"demo":"live"],details:()=>[...q.all,"details"]}}}});