import{at as e,rt as t,u as n}from"./vendor-DxyDeVV0.js";import"./vendor-charts-B__IZl80.js";import"./vendor-query-BzUZE9-d.js";import{n as r}from"./vendor-i18n-BSzAmJZ7.js";import{l as i,t as a}from"./theme-XEO8amRP.js";import{a as o,i as s,n as c,r as l,t as u}from"./card-DR_iUne-.js";import"./client-CzSh7g6B.js";import"./useChartAnimation-DiAB65-P.js";import"./usePrefetchData-Dtc8Q6b7.js";import{t as d}from"./api-B7Y8ZWSI.js";import{n as f,r as p,t as m}from"./MetricSummaryCard-CquAHZFy.js";var h=e(),g=t();const _=(0,h.memo)(({showCard:e=!0,height:t=200,className:i})=>{let{t:o}=r(),{data:p,isLoading:m,isError:_,refetch:y}=d();if(_||!p)return(0,g.jsx)(v,{showCard:e,className:i,children:(0,g.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-8 text-center`,children:[(0,g.jsx)(`p`,{className:`text-sm text-slate-500 mb-3`,children:o(`common.error`)}),(0,g.jsx)(`button`,{onClick:()=>y(),className:`px-4 py-2 text-sm font-medium text-white bg-bp rounded-lg hover:opacity-90 transition-opacity`,children:o(`common.retry`)})]})});let b=(0,h.useMemo)(()=>p.chartData.map(e=>({dateLabel:e.dateLabel,high:e.systolic,low:e.diastolic,date:e.date})),[p.chartData]),x=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)(`div`,{className:`flex items-center gap-4 mb-3`,children:[(0,g.jsxs)(`div`,{className:`flex items-center gap-1.5`,children:[(0,g.jsx)(`span`,{className:`w-3 h-0.5 rounded`,style:{backgroundColor:a.bp.primary}}),(0,g.jsx)(`span`,{className:`text-xs text-slate-500`,children:o(`vitals.systolic`)})]}),(0,g.jsxs)(`div`,{className:`flex items-center gap-1.5`,children:[(0,g.jsx)(`span`,{className:`w-3 h-0.5 rounded border-dashed`,style:{borderBottomWidth:2,borderColor:a.bp.secondary}}),(0,g.jsx)(`span`,{className:`text-xs text-slate-500`,children:o(`vitals.diastolic`)})]}),m&&(0,g.jsxs)(`div`,{className:`ml-auto flex items-center gap-1.5 text-xs text-slate-400`,children:[(0,g.jsx)(n,{className:`w-3 h-3 animate-spin`}),(0,g.jsx)(`span`,{children:o(`common.loading`)})]})]}),(0,g.jsx)(f,{data:b,type:`range`,color:a.bp.primary,secondaryColor:a.bp.secondary,height:t,yDomain:[p.yAxisRange.min,p.yAxisRange.max]})]});return e?(0,g.jsxs)(u,{className:i,children:[(0,g.jsx)(l,{children:(0,g.jsx)(s,{children:o(`page.bloodPressure.trendTitle`)})}),(0,g.jsx)(c,{children:x})]}):(0,g.jsx)(`div`,{className:i,children:x})});function v({showCard:e,className:t,children:n}){return e?(0,g.jsx)(u,{className:t,children:(0,g.jsx)(c,{className:`py-4`,children:n})}):(0,g.jsx)(`div`,{className:o(`p-4`,t),children:n})}(0,h.memo)(({className:e})=>{let{t}=r(),{data:a,isLoading:o,isError:s}=d();if(s||!a||!a.latestReading)return(0,g.jsx)(u,{className:e,children:(0,g.jsx)(c,{className:`py-8 text-center`,children:(0,g.jsx)(`p`,{className:`text-sm text-slate-500`,children:t(`common.noData`)})})});let{summary:l,latestReading:f}=a,p=(0,h.useMemo)(()=>l.systolicChange===0?void 0:`${l.systolicChange>0?`+`:``}${l.systolicChange}`,[l.systolicChange]),_=(0,h.useMemo)(()=>[{labelKey:`page.bloodPressure.averageReading`,value:`${l.avgSystolic}/${l.avgDiastolic}`,unit:t(`units.mmHg`)},{labelKey:`status.`+l.status,value:t(l.statusKey)}],[l.avgSystolic,l.avgDiastolic,l.status,l.statusKey,t]);return(0,g.jsx)(m,{className:e,titleKey:`vitals.bloodPressure`,value:`${f.systolic}/${f.diastolic}`,unit:t(`units.mmHg`),trend:l.systolicTrend,trendValue:p,accentColor:i.bp,subMetrics:_,loadingIndicator:o&&(0,g.jsxs)(`div`,{className:`flex items-center gap-1.5 text-xs text-slate-400`,children:[(0,g.jsx)(n,{className:`w-3 h-3 animate-spin`}),(0,g.jsx)(`span`,{children:t(`common.loading`)})]})})});function y(){return(0,g.jsx)(p,{children:(0,g.jsx)(`div`,{className:`w-full max-w-md p-4`,children:(0,g.jsx)(_,{showCard:!1,height:200})})})}export{y as BPTrendWidgetPage};