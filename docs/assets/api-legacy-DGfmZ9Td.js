System.register(["./vendor-legacy-BFWz_Ol4.js","./vendor-query-legacy-DmLb6WcG.js","./vendor-i18n-legacy-fjOwBjkb.js","./theme-legacy-BPmhlnTm.js","./card-legacy-BAqfJ-x3.js","./DistributionCard-legacy-D0GcXimJ.js","./TrendLineChart-legacy-OymNiGz5.js","./WeeklyOverviewCard-legacy-BA9KKe86.js","./usePrefetchData-legacy-IN3Mv77r.js","./DataAnalysisCard-legacy-Bo096RDw.js"],function(e,a){var n,l,t,s,i,o,r,d,u,m,c,v,y,g,x,h,p,w,f,j,k,b,N,K,A,D,S,_,C;function L(e){const a=new Date(e);return`${String(a.getMonth()+1).padStart(2,"0")}/${String(a.getDate()).padStart(2,"0")}`}function T(e){return e&&_[e]||"weekdays.mon"}return e({a:function({data:e,className:a,isLoading:n}){var l,s,i,o;const{t:r}=c(),d=y.spo2,u=null!==(l=null==e||null===(s=e.summary)||void 0===s?void 0:s.distribution)&&void 0!==l?l:[],m=null!==(i=null==e||null===(o=e.summary)||void 0===o?void 0:o.totalCount)&&void 0!==i?i:0,v=D.map(e=>{const a=u.find(a=>a.type===e);return{type:e,label:r(S[e]||`status.${e}`),count:(null==a?void 0:a.count)||0,percent:(null==a?void 0:a.percent)||0,color:g.spo2[e]||"#94A3B8"}});return(0,K.jsx)(p,{title:r("page.spo2.statistics"),icon:t,themeColor:d,donutThickness:12,pieChartSize:"small",items:v,centerValue:m,centerLabel:r("common.times"),showCount:!0,columns:1,className:a,isLoading:n})},i:function({data:e,className:a,isLoading:l}){var t,s,i,o,r,d,u,m;const{t:v}=c(),g=y.spo2,x=null!==(t=null==e||null===(s=e.weeklySummary)||void 0===s?void 0:s.dataAnalysis)&&void 0!==t?t:[],h=[v("page.spo2.defaultAnalysis1",{avg:null!==(i=null==e||null===(o=e.summary)||void 0===o?void 0:o.avgValue)&&void 0!==i?i:"--"}),v("page.spo2.defaultAnalysis2",{max:null!==(r=null==e||null===(d=e.summary)||void 0===d?void 0:d.maxValue)&&void 0!==r?r:"--",maxDay:e?v(e.summary.maxWeekdayKey):"--"}),v("page.spo2.defaultAnalysis3",{min:null!==(u=null==e||null===(m=e.summary)||void 0===m?void 0:m.minValue)&&void 0!==u?u:"--",minDay:e?v(e.summary.minWeekdayKey):"--"})];return(0,K.jsx)(b,{titleKey:"page.spo2.dataAnalysis",Icon:n,items:(x.length>0?x:h).map(e=>"string"==typeof e?e:e.content),themeColor:g,className:a,isLoading:l})},n:function(e){return m({queryKey:C.trend(e),queryFn:async()=>{console.log("[SpO2 API] Fetching with dateRange:",e);const a=await j(e?{start_date:e.startDate,end_date:e.endDate}:void 0);return console.log("[SpO2 API] Result:",a),a},select:e=>function(e){var a,n,l,t,s,i,o,r,d,u,m,c,v,y,g;console.log("[SpO2 Adapter] Input:",e);const x=((null==e||null===(a=e.trend_chart)||void 0===a?void 0:a.chart_data)||[]).map(e=>{var a;const n=new Date(e.date),l=null!==(a=e.avg)&&void 0!==a?a:Math.round((e.max+e.min)/2);return{date:n,dateLabel:L(e.date),weekdayKey:_[e.label]||"weekdays.mon",max:e.max||0,min:e.min||0,avg:l,range:[e.min||0,e.max||0]}}),h=(null==e||null===(n=e.overview)||void 0===n?void 0:n.average)||0,p=(null==e||null===(l=e.overview)||void 0===l?void 0:l.min)||0,w=(null==e||null===(t=e.overview)||void 0===t?void 0:t.max)||0,f=T(null==e||null===(s=e.overview)||void 0===s?void 0:s.max_label),j=T(null==e||null===(i=e.overview)||void 0===i?void 0:i.min_label),k=(b=h)>=95?"normal":b>=90?"low":"too_low";var b;const N=(null==e?void 0:e.comparison)||{},K=N.changes||{},A=function(e){return"up"===e||"down"===e||"stable"===e?e:"stable"}(null===(o=K.average)||void 0===o?void 0:o.trend),D=(null===(r=K.average)||void 0===r?void 0:r.value)||0,S=(null===(d=N.previous)||void 0===d?void 0:d.average)||0,C=x.length>0?{avg:x[x.length-1].avg,min:x[x.length-1].min,max:x[x.length-1].max,date:x[x.length-1].date}:null,V=(null==e?void 0:e.weekly_summary)||{},W={overview:V.overview||null,highlights:V.highlights||null,suggestions:V.suggestions||[],dataAnalysis:(V.data_analysis||[]).map(e=>({content:e}))},O={chartData:x,yAxisRange:(null==e||null===(u=e.trend_chart)||void 0===u?void 0:u.y_axis_range)||{min:85,max:100},averageLine:(null==e||null===(m=e.trend_chart)||void 0===m?void 0:m.average_line)||h,summary:{avgValue:h,minValue:p,maxValue:w,maxWeekdayKey:f,minWeekdayKey:j,status:k,statusKey:`status.${k}`,trend:A,changeValue:D,totalCount:(null==e||null===(c=e.statistics)||void 0===c?void 0:c.total_count)||0,distribution:(null==e||null===(v=e.statistics)||void 0===v?void 0:v.distribution)||[],previousAvg:S},comparison:{current:{average:(null===(y=N.current)||void 0===y?void 0:y.average)||h},previous:{average:(null===(g=N.previous)||void 0===g?void 0:g.average)||0},insight:N.insight||null},weeklySummary:W,latestReading:C};return console.log("[SpO2 Adapter] Output:",O),O}(e),staleTime:3e5,gcTime:6e5})},o:function({data:e,className:a,isLoading:n}){var t,i,o,d,m,g,p,f,j,k,b,D,S;const{t:_}=c(),C=y.spo2,L=(0,N.useMemo)(()=>[{name:"Mon",weekdayKey:"weekday.mon",range:[96,99],avg:97,max:99,min:96},{name:"Tues",weekdayKey:"weekday.tue",range:[95,98],avg:97,max:98,min:95},{name:"Wed",weekdayKey:"weekday.wed",range:[96,99],avg:98,max:99,min:96},{name:"Thu",weekdayKey:"weekday.thu",range:[95,98],avg:97,max:98,min:95},{name:"Fri",weekdayKey:"weekday.fri",range:[96,99],avg:97,max:99,min:96},{name:"Sat",weekdayKey:"weekday.sat",range:[97,99],avg:98,max:99,min:97},{name:"Sun",weekdayKey:"weekday.sun",range:[96,98],avg:97,max:98,min:96}],[]),T=(0,N.useMemo)(()=>{var a,n;return null!==(a=null==e||null===(n=e.chartData)||void 0===n?void 0:n.map((e,a)=>({name:["Mon","Tues","Wed","Thu","Fri","Sat","Sun"][a%7],weekdayKey:e.weekdayKey,range:[e.min,e.max],avg:e.avg,max:e.max,min:e.min})))&&void 0!==a?a:L},[null==e?void 0:e.chartData,L]),V=(0,N.useMemo)(()=>()=>{if(!e)return null;const{trend:a,changeValue:n}=e.summary;if(0===n)return null;const t="up"===a,i=t?s:l;return(0,K.jsxs)("span",{className:"flex items-center gap-0.5 text-sm",style:{color:t?x.trend.down:x.trend.up},children:[(0,K.jsx)(i,{className:"w-3 h-3"}),Math.abs(n)]})},[e,x.trend]);return(0,K.jsxs)(h,{className:`${a} relative overflow-hidden`,children:[(0,K.jsx)("div",{className:"absolute inset-0 rounded-2xl flex items-center justify-center z-10 transition-all duration-300 ease-in-out "+(n?"opacity-100":"opacity-0 pointer-events-none"),style:{backgroundColor:v.loadingOverlay},children:(0,K.jsx)(u,{className:"w-8 h-8 text-white animate-spin"})}),(0,K.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,K.jsx)(r,{className:"w-5 h-5",style:{color:C}}),(0,K.jsx)("h3",{className:"text-base font-semibold text-slate-800",children:_("page.spo2.trendyReport")})]}),(0,K.jsxs)("div",{className:"rounded-xl px-5 py-4 mb-4 mx-1",style:{backgroundColor:x.background.summaryBox},children:[(0,K.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,K.jsxs)("div",{children:[(0,K.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:_("page.spo2.weeksAverage")}),(0,K.jsxs)("div",{className:"flex items-baseline gap-1.5",children:[(0,K.jsx)("span",{className:"text-3xl font-bold",style:{color:C},children:null!==(t=null==e||null===(i=e.summary)||void 0===i?void 0:i.avgValue)&&void 0!==t?t:"--"}),(0,K.jsx)("span",{className:"text-lg text-slate-500",children:"%"}),V()]}),(0,K.jsxs)("p",{className:"text-xs text-slate-400 mt-0.5",children:[_("time.lastWeek"),": ",null!==(o=null==e||null===(d=e.summary)||void 0===d?void 0:d.previousAvg)&&void 0!==o?o:"--","%"]})]}),(0,K.jsx)("div",{className:"text-right text-xs text-slate-400 px-3 py-1.5 rounded-lg bg-white/60",children:(0,K.jsxs)("p",{children:[_("page.spo2.normalRange"),": 95% - 100%"]})})]}),(0,K.jsxs)("div",{className:"flex gap-6",children:[(0,K.jsxs)("div",{children:[(0,K.jsxs)("span",{className:"text-xs text-slate-400",children:[_("common.max"),"(",e?_(e.summary.maxWeekdayKey):"--",")"]}),(0,K.jsxs)("p",{className:"text-xl font-semibold",style:{color:C},children:[null!==(m=null==e||null===(g=e.summary)||void 0===g?void 0:g.maxValue)&&void 0!==m?m:"--"," ",(0,K.jsx)("span",{className:"text-sm font-normal",children:"%"})]})]}),(0,K.jsxs)("div",{children:[(0,K.jsxs)("span",{className:"text-xs text-slate-400",children:[_("common.min"),"(",e?_(e.summary.minWeekdayKey):"--",")"]}),(0,K.jsxs)("p",{className:"text-xl font-semibold text-slate-600",children:[null!==(p=null==e||null===(f=e.summary)||void 0===f?void 0:f.minValue)&&void 0!==p?p:"--"," ",(0,K.jsx)("span",{className:"text-sm font-normal",children:"%"})]})]})]})]}),(0,K.jsx)(w,{data:T,lines:[{dataKey:"avg",areaDataKey:"range",color:C,label:_("page.spo2.mean"),showArea:!0,gradientId:"spo2RangeGradient",legendShape:"line"}],xAxisKey:"name",yAxisDomain:[null!==(j=null==e||null===(k=e.yAxisRange)||void 0===k?void 0:k.min)&&void 0!==j?j:90,null!==(b=null==e||null===(D=e.yAxisRange)||void 0===D?void 0:D.max)&&void 0!==b?b:100],renderTooltip:e=>(0,K.jsx)(A,{...e}),referenceLine:{value:null!==(S=null==e?void 0:e.averageLine)&&void 0!==S?S:97,color:C},height:224})]})},r:function({data:e,className:a,isLoading:n}){const{t:l}=c(),t=y.spo2,s=null==e?void 0:e.weeklySummary;return(0,K.jsx)(f,{titleKey:"page.spo2.weeklyOverview",Icon:o,overallText:(null==s?void 0:s.overview)||l("page.spo2.defaultOverview",{defaultValue:"Your blood pressure is generally within the ideal range. Although your systolic blood pressure has risen slightly compared to last week, it remains within the normal fluctuation range."}),highlightText:(null==s?void 0:s.highlights)||l("page.spo2.defaultHighlights",{defaultValue:"The trend chart shows that your blood pressure rose significantly during the week (Wednesday and Thursday), with a peak systolic pressure approaching 150 mmHg. Meanwhile, the statistics show that your blood pressure measurements fluctuated considerably across different levels. We will continue to monitor your condition and help you identify any possible causes for the elevated blood pressure."}),highlightLabelKey:"page.spo2.anomalyAlert",highlightColor:"#FBBF24",suggestions:null==s?void 0:s.suggestions,themeColor:t,className:a,isLoading:n})},t:function(){return k({featureName:"SpO2",queryKeyFn:C.trend,fetchFn:e=>j({start_date:e.startDate,end_date:e.endDate})})}}),{setters:[function(e){n=e.C,l=e.E,t=e.O,s=e.T,i=e.at,o=e.h,r=e.r,d=e.rt,u=e.u},function(e){m=e.t},function(e){c=e.n},function(e){v=e.c,y=e.l,g=e.o,x=e.s},function(e){h=e.t},function(e){p=e.t},function(e){w=e.t},function(e){f=e.t},function(e){j=e.s,k=e.t},function(e){b=e.t}],execute:function(){N=i(),K=d(),A=(0,N.memo)(({active:e,payload:a})=>{var n;const{t:l}=c();if(!e||!a||0===a.length)return null;const t=null===(n=a[0])||void 0===n?void 0:n.payload;return t?(0,K.jsxs)("div",{className:"bg-slate-700 text-white px-3 py-2 rounded-lg text-sm shadow-lg",children:[(0,K.jsx)("p",{className:"font-medium mb-1",children:l(t.weekdayKey)}),(0,K.jsxs)("p",{className:"text-cyan-300",children:[l("common.max"),": ",t.max,"%"]}),(0,K.jsxs)("p",{className:"text-cyan-200",children:[l("common.min"),": ",t.min,"%"]})]}):null}),D=["normal","low","too_low"],S={normal:"status.normal",low:"status.low",too_low:"status.tooLow"},_={"周一":"weekdays.mon","周二":"weekdays.tue","周三":"weekdays.wed","周四":"weekdays.thu","周五":"weekdays.fri","周六":"weekdays.sat","周日":"weekdays.sun"},C={all:["spo2"],trend:e=>[...C.all,"trend",null==e?void 0:e.startDate,null==e?void 0:e.endDate],details:()=>[...C.all,"details"]}}}});