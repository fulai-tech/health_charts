System.register(["./vendor-legacy-BFWz_Ol4.js","./vendor-query-legacy-DmLb6WcG.js","./vendor-i18n-legacy-fjOwBjkb.js","./theme-legacy-BPmhlnTm.js","./card-legacy-BAqfJ-x3.js","./DistributionCard-legacy-D0GcXimJ.js","./TrendLineChart-legacy-OymNiGz5.js","./WeeklyOverviewCard-legacy-BA9KKe86.js","./usePrefetchData-legacy-IN3Mv77r.js","./DataAnalysisCard-legacy-Bo096RDw.js"],function(e,a){var t,n,l,s,i,o,r,d,u,m,c,v,g,h,y,x,p,w,f,k,j,b,N,R,K,_,A,D,C,T;function L(e){const a=new Date(e);return`${String(a.getMonth()+1).padStart(2,"0")}/${String(a.getDate()).padStart(2,"0")}`}return e({a:function({data:e,className:a,isLoading:t}){var n,s,i,o;const{t:r}=c(),d=g.heartRate,u=null!==(n=null==e||null===(s=e.summary)||void 0===s?void 0:s.distribution)&&void 0!==n?n:[],m=null!==(i=null==e||null===(o=e.summary)||void 0===o?void 0:o.totalCount)&&void 0!==i?i:0,v=A.map(e=>{const a=u.find(a=>a.type===e);return{type:e,label:r(D[e]||`status.${e}`),count:(null==a?void 0:a.count)||0,percent:(null==a?void 0:a.percent)||0,color:h.heartRate[e]||"#94A3B8"}});return(0,R.jsx)(p,{title:r("page.heartRate.statistics"),icon:l,themeColor:d,pieChartSize:"medium",donutThickness:12,items:v,centerValue:m,centerLabel:r("page.heartRate.totalTests"),showCount:!0,columns:1,className:a,isLoading:t})},i:function({data:e,className:a,isLoading:n}){var l,s,i,o,r,d,u,m;const{t:v}=c(),h=g.heartRate,y=null!==(l=null==e||null===(s=e.weeklySummary)||void 0===s?void 0:s.dataAnalysis)&&void 0!==l?l:[],x=[v("page.heartRate.defaultAnalysis1",{avg:null!==(i=null==e||null===(o=e.summary)||void 0===o?void 0:o.avgValue)&&void 0!==i?i:"--"}),v("page.heartRate.defaultAnalysis2",{max:null!==(r=null==e||null===(d=e.summary)||void 0===d?void 0:d.maxValue)&&void 0!==r?r:"--",maxDay:e?v(e.summary.maxWeekdayKey):"--"}),v("page.heartRate.defaultAnalysis3",{min:null!==(u=null==e||null===(m=e.summary)||void 0===m?void 0:m.minValue)&&void 0!==u?u:"--",minDay:e?v(e.summary.minWeekdayKey):"--"})];return(0,R.jsx)(b,{titleKey:"page.heartRate.dataAnalysis",Icon:t,items:(y.length>0?y:x).map(e=>"string"==typeof e?e:e.content),themeColor:h,className:a,isLoading:n})},n:function(){return j({featureName:"HR",queryKeyFn:T.trend,fetchFn:e=>k({start_date:e.startDate,end_date:e.endDate})})},r:function({data:e,className:a,isLoading:t}){const{t:n}=c(),l=g.heartRate,s=null==e?void 0:e.weeklySummary;return(0,R.jsx)(f,{titleKey:"page.heartRate.weeklyOverview",Icon:o,overallText:(null==s?void 0:s.overview)||n("page.heartRate.defaultOverview",{defaultValue:"Your heart rate is generally within the normal range this week. Keep up with your regular exercise routine!"}),highlightText:(null==s?void 0:s.highlights)||n("page.heartRate.defaultHighlights",{defaultValue:"The trend chart shows some fluctuations in your heart rate during the week. This is normal and can be influenced by physical activity, stress levels, and sleep quality."}),highlightLabelKey:"page.heartRate.anomalyAlert",highlightColor:"#FBBF24",suggestions:null==s?void 0:s.suggestions,themeColor:l,className:a,isLoading:t})},t:function(e){return m({queryKey:T.trend(e),queryFn:async()=>{console.log("[HR API] Fetching with dateRange:",e);const a=await k(e?{start_date:e.startDate,end_date:e.endDate}:void 0);return console.log("[HR API] Result:",a),a},select:e=>function(e){var a,t,n,l,s,i,o,r,d,u,m;const c=((null==e||null===(a=e.trend_chart)||void 0===a?void 0:a.chart_data)||[]).map(e=>{var a,t,n,l,s,i;const o=new Date(e.date),r=null!==(a=null!==(t=e.max)&&void 0!==t?t:e.value)&&void 0!==a?a:0,d=null!==(n=null!==(l=e.min)&&void 0!==l?l:e.value)&&void 0!==n?n:0,u=null!==(s=null!==(i=e.avg)&&void 0!==i?i:e.value)&&void 0!==s?s:Math.round((r+d)/2);return{date:o,dateLabel:L(e.date),weekdayKey:C[e.label]||"weekdays.mon",max:r,min:d,avg:u}}),v=(null==e?void 0:e.overview)||{},g=v.average||0,h=null!==(t=v.max)&&void 0!==t?t:c.length>0?Math.max(...c.map(e=>e.max)):0,y=null!==(n=v.min)&&void 0!==n?n:c.length>0?Math.min(...c.map(e=>e.min)):0,x=v.max_label&&C[v.max_label]||"weekdays.mon",p=v.min_label&&C[v.min_label]||"weekdays.mon",w=v.resting_avg,f=(k=w||g)<60?"low":k<=100?"normal":k<=120?"elevated":"high";var k;const j=(null==e?void 0:e.comparison)||{},b=j.changes||{},N=function(e){return"up"===e||"down"===e||"stable"===e?e:"stable"}(null===(l=b.average)||void 0===l?void 0:l.trend),R=(null===(s=b.average)||void 0===s?void 0:s.value)||0,K=(null===(i=j.previous)||void 0===i?void 0:i.average)||0,_=c.length>0?{value:c[c.length-1].avg,date:c[c.length-1].date}:null,A=(null==e?void 0:e.weekly_summary)||{};return{chartData:c,yAxisRange:(null==e||null===(o=e.trend_chart)||void 0===o?void 0:o.y_axis_range)||{min:40,max:160},averageLine:(null==e||null===(r=e.trend_chart)||void 0===r?void 0:r.average_line)||g,summary:{avgValue:g,minValue:y,maxValue:h,minWeekdayKey:p,maxWeekdayKey:x,previousAvg:K,avgResting:w,status:f,statusKey:`status.${f}`,trend:N,changeValue:R,totalCount:(null==e||null===(d=e.statistics)||void 0===d?void 0:d.total_count)||0,distribution:(null==e||null===(u=e.statistics)||void 0===u?void 0:u.distribution)||[]},comparison:{current:{average:(null===(m=j.current)||void 0===m?void 0:m.average)||g},previous:{average:K},insight:j.insight||null},weeklySummary:{overview:A.overview||null,highlights:A.highlights||null,suggestions:A.suggestions||[],dataAnalysis:A.data_analysis||[]},latestReading:_}}(e),staleTime:3e5,gcTime:6e5})}}),{setters:[function(e){t=e.C,n=e.E,l=e.O,s=e.T,i=e.at,o=e.h,r=e.r,d=e.rt,u=e.u},function(e){m=e.t},function(e){c=e.n},function(e){v=e.c,g=e.l,h=e.o,y=e.s},function(e){x=e.t},function(e){p=e.t},function(e){w=e.t},function(e){f=e.t},function(e){k=e.i,j=e.t},function(e){b=e.t}],execute:function(){N=i(),R=d(),K=(0,N.memo)(({active:e,payload:a})=>{var t;const{t:n}=c();if(!e||!a||0===a.length)return null;const l=null===(t=a[0])||void 0===t?void 0:t.payload;return l?(0,R.jsxs)("div",{className:"bg-slate-700 text-white px-3 py-2 rounded-lg text-sm shadow-lg",children:[(0,R.jsx)("p",{className:"font-medium mb-1",children:n(l.weekdayKey)}),(0,R.jsxs)("p",{className:"text-red-300",children:[n("common.average"),": ",l.avg]}),(0,R.jsxs)("p",{className:"text-red-200",children:[n("common.max"),": ",l.max]}),(0,R.jsxs)("p",{className:"text-red-100",children:[n("common.min"),": ",l.min]})]}):null}),_=({data:e,className:a,isLoading:t})=>{var l,i,o,d,m,h,p,f,k,j,b,_,A;const{t:D}=c(),C=g.heartRate,T=(0,N.useMemo)(()=>[{name:"Mon",weekdayKey:"weekday.mon",range:[60,85],avg:72,max:85,min:60},{name:"Tues",weekdayKey:"weekday.tue",range:[62,88],avg:75,max:88,min:62},{name:"Wed",weekdayKey:"weekday.wed",range:[58,82],avg:70,max:82,min:58},{name:"Thu",weekdayKey:"weekday.thu",range:[65,90],avg:78,max:90,min:65},{name:"Fri",weekdayKey:"weekday.fri",range:[60,84],avg:72,max:84,min:60},{name:"Sat",weekdayKey:"weekday.sat",range:[55,80],avg:68,max:80,min:55},{name:"Sun",weekdayKey:"weekday.sun",range:[58,83],avg:70,max:83,min:58}],[]),L=(0,N.useMemo)(()=>{var a,t;return null!==(a=null==e||null===(t=e.chartData)||void 0===t?void 0:t.map((e,a)=>({name:["Mon","Tues","Wed","Thu","Fri","Sat","Sun"][a%7],weekdayKey:e.weekdayKey,range:[e.min,e.max],avg:e.avg,max:e.max,min:e.min})))&&void 0!==a?a:T},[null==e?void 0:e.chartData,T]);return(0,R.jsxs)(x,{className:`${a} relative overflow-hidden`,children:[(0,R.jsx)("div",{className:"absolute inset-0 rounded-2xl flex items-center justify-center z-10 transition-all duration-300 ease-in-out "+(t?"opacity-100":"opacity-0 pointer-events-none"),style:{backgroundColor:v.loadingOverlay},children:(0,R.jsx)(u,{className:"w-8 h-8 text-white animate-spin"})}),(0,R.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,R.jsx)(r,{className:"w-5 h-5",style:{color:C}}),(0,R.jsx)("h3",{className:"text-base font-semibold text-slate-800",children:D("page.heartRate.trendyReport")})]}),(0,R.jsxs)("div",{className:"rounded-xl px-5 py-4 mb-4 mx-1",style:{backgroundColor:y.background.summaryBox},children:[(0,R.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,R.jsxs)("div",{children:[(0,R.jsx)("p",{className:"text-xs text-slate-500 mb-1",children:D("page.heartRate.weeksAverage")}),(0,R.jsxs)("div",{className:"flex items-baseline gap-1.5",children:[(0,R.jsx)("span",{className:"text-3xl font-bold",style:{color:C},children:null!==(l=null==e||null===(i=e.summary)||void 0===i?void 0:i.avgValue)&&void 0!==l?l:"--"}),(0,R.jsxs)("span",{className:"text-lg text-slate-500",children:["/",D("units.minute")]}),(()=>{if(!e)return null;const{trend:a,changeValue:t}=e.summary;if(0===t)return null;const l="up"===a,i=l?s:n;return(0,R.jsxs)("span",{className:"flex items-center gap-0.5 text-sm",style:{color:l?y.trend.up:y.trend.down},children:[(0,R.jsx)(i,{className:"w-3 h-3"}),Math.abs(t)]})})()]}),(0,R.jsxs)("p",{className:"text-xs text-slate-400 mt-0.5",children:[D("time.lastWeek"),": ",null!==(o=null==e||null===(d=e.summary)||void 0===d?void 0:d.previousAvg)&&void 0!==o?o:"--","/",D("units.minute")]})]})}),(0,R.jsxs)("div",{className:"flex gap-6",children:[(0,R.jsxs)("div",{children:[(0,R.jsxs)("span",{className:"text-xs text-slate-400",children:[D("common.max"),"(",e?D(e.summary.maxWeekdayKey):"--",")"]}),(0,R.jsxs)("p",{className:"text-xl font-semibold",style:{color:C},children:[null!==(m=null==e||null===(h=e.summary)||void 0===h?void 0:h.maxValue)&&void 0!==m?m:"--"," ",(0,R.jsxs)("span",{className:"text-sm font-normal",children:["/",D("units.minute")]})]})]}),(0,R.jsxs)("div",{children:[(0,R.jsxs)("span",{className:"text-xs text-slate-400",children:[D("common.min"),"(",e?D(e.summary.minWeekdayKey):"--",")"]}),(0,R.jsxs)("p",{className:"text-xl font-semibold text-slate-600",children:[null!==(p=null==e||null===(f=e.summary)||void 0===f?void 0:f.minValue)&&void 0!==p?p:"--"," ",(0,R.jsxs)("span",{className:"text-sm font-normal",children:["/",D("units.minute")]})]})]})]})]}),(0,R.jsx)(w,{data:L,lines:[{dataKey:"avg",areaDataKey:"range",color:C,label:D("page.heartRate.mean"),showArea:!0,gradientId:"hrRangeGradient",legendShape:"line"}],xAxisKey:"name",yAxisDomain:[null!==(k=null==e||null===(j=e.yAxisRange)||void 0===j?void 0:j.min)&&void 0!==k?k:50,null!==(b=null==e||null===(_=e.yAxisRange)||void 0===_?void 0:_.max)&&void 0!==b?b:120],renderTooltip:e=>(0,R.jsx)(K,{...e}),referenceLine:{value:null!==(A=null==e?void 0:e.averageLine)&&void 0!==A?A:72,color:C},height:224})]})},e("o",(0,N.memo)(_)),A=["too_high","high","normal","slow"],D={normal:"status.normal",high:"status.high",too_high:"status.tooHigh",slow:"status.slow",low:"status.low"},C={"周一":"weekdays.mon","周二":"weekdays.tue","周三":"weekdays.wed","周四":"weekdays.thu","周五":"weekdays.fri","周六":"weekdays.sat","周日":"weekdays.sun"},T={all:["heart-rate"],trend:e=>[...T.all,"trend",null==e?void 0:e.startDate,null==e?void 0:e.endDate],details:()=>[...T.all,"details"]}}}});