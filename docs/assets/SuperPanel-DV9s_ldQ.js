import{At as e}from"./vendor-kaGLFeG7.js";import"./vendor-charts-BuUdTzGu.js";import{D as t,I as n,O as r,U as i,d as a,g as o,h as s,it as c,l,lt as u,t as d,x as f,y as p}from"./vendor-react-v-H7No9y.js";import{a as m,i as ee,n as h,o as g,r as _,t as v}from"./index-iEoyQjPA.js";var y=e(),b=u();function x({enabled:e,onChange:t,size:n=`md`}){let r=n===`sm`?`h-5 w-9`:`h-6 w-11`,i=n===`sm`?`h-3 w-3`:`h-4 w-4`,a=n===`sm`?e?`translate-x-5`:`translate-x-1`:e?`translate-x-6`:`translate-x-1`;return(0,b.jsx)(`button`,{onClick:()=>t(!e),className:g(`relative inline-flex items-center rounded-full transition-colors`,`focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2`,r,e?`bg-orange-500`:`bg-slate-300`),role:`switch`,"aria-checked":e,children:(0,b.jsx)(`span`,{className:g(`inline-block transform rounded-full bg-white transition-transform`,i,a)})})}function S({icon:e,label:t,children:n}){return(0,b.jsxs)(`div`,{className:`flex items-center justify-between py-3 border-b border-slate-100 last:border-b-0`,children:[(0,b.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,b.jsx)(`div`,{className:`w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-slate-600`,children:e}),(0,b.jsx)(`span`,{className:`text-sm font-medium text-slate-700`,children:t})]}),(0,b.jsx)(`div`,{className:`flex items-center gap-2`,children:n})]})}var C=100;function w(){let{t:e,i18n:u}=c(),{isAuthenticated:d,username:h,logout:w}=ee(),{language:T,setLanguage:E}=m(),[D,O]=(0,y.useState)(!1),[k,A]=(0,y.useState)(!1),[j,M]=(0,y.useState)(!1),[N,P]=(0,y.useState)(null),[F,I]=(0,y.useState)([]),[L,R]=(0,y.useState)(!1),[z,B]=(0,y.useState)(!1),V=(0,y.useRef)(null),H=(0,y.useRef)(0),U=(0,y.useRef)(!1),W=(0,y.useRef)([]),G=(0,y.useRef)(null);(0,y.useEffect)(()=>{let e=()=>{B(window.innerWidth<360||window.innerHeight<500)};return e(),window.addEventListener(`resize`,e),()=>window.removeEventListener(`resize`,e)},[]),(0,y.useEffect)(()=>{let e={log:console.log,warn:console.warn,error:console.error,info:console.info};G.current=e;let t=(e,t)=>{H.current+=1;let n=new Date().toLocaleTimeString(),r=t.map(e=>{if(typeof e==`object`&&e)try{let t=JSON.stringify(e,null,2);return t.length>2e3?t.slice(0,2e3)+`... (truncated)`:t}catch(e){return`[Circular/Unserializable Object]`}return String(e)}).join(` `);return{id:H.current,timestamp:n,level:e,message:r,args:t,count:1,firstTimestamp:n,lastTimestamp:n}},n=setInterval(()=>{W.current.length!==0&&I(e=>{let t=[...e],n=[...W.current];return W.current=[],n.forEach(e=>{let n=t[t.length-1];n&&n.level===e.level&&n.message===e.message?t[t.length-1]={...n,count:n.count+1,lastTimestamp:e.timestamp,timestamp:e.timestamp}:t.push(e)}),t.length>C&&(t=t.slice(-C)),t})},500),r=n=>(...r)=>{if(e[n].apply(console,r),!U.current)try{U.current=!0;let e=r.join(` `);if(e.includes(`i18next::translator: missingKey`)||e.includes(`SuperPanel`)&&e.includes(`translation`))return;let i=t(n,r);W.current.push(i)}catch(e){}finally{U.current=!1}};return console.log=r(`log`),console.warn=r(`warn`),console.error=r(`error`),console.info=r(`info`),()=>{console.log=e.log,console.warn=e.warn,console.error=e.error,console.info=e.info,clearInterval(n)}},[]),(0,y.useEffect)(()=>{let e=e=>{V.current&&!V.current.contains(e.target)&&O(!1)};return D&&document.addEventListener(`mousedown`,e),()=>document.removeEventListener(`mousedown`,e)},[D]);let K=()=>{let e=u.language.startsWith(`en`)?`zh`:`en`;u.changeLanguage(e),E(e)},q=()=>{R(!L)},J=()=>{I([])},Y=()=>{window.location.reload()},X=()=>{try{localStorage.clear(),sessionStorage.clear(),document.cookie.split(`;`).forEach(e=>{let t=e.indexOf(`=`),n=t>-1?e.substr(0,t).trim():e.trim();document.cookie=`${n}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`,document.cookie=`${n}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=${window.location.hostname}`,document.cookie=`${n}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=.${window.location.hostname}`}),`indexedDB`in window&&indexedDB.databases().then(e=>{e.forEach(e=>{e.name&&indexedDB.deleteDatabase(e.name)})}).catch(()=>{}),alert($?`All storage cleared! Page will reload.`:`所有存储已清空！页面即将重新加载。`),window.location.reload()}catch(n){var e,t;!((e=G.current)==null||(t=e.error)==null)&&t.call(e,`Clear storage failed:`,n)||console.error(`Clear storage failed:`,n),alert($?`Failed to clear storage completely`:`清空存储失败`)}},Z=async(t,n)=>{M(!0),P(null);try{await _.login({username:t,password:n}),A(!1)}catch(t){var r,i;!((r=G.current)==null||(i=r.error)==null)&&i.call(r,`Login failed:`,t)||console.error(`Login failed:`,t),P(t instanceof Error?t.message:e(`auth.loginFailed`))}finally{M(!1)}},Q=()=>{w()},$=u.language.startsWith(`en`);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(`div`,{ref:V,className:g(`fixed z-[9999]`,z?`bottom-3 right-3`:`bottom-6 right-6`),children:[D&&(0,b.jsxs)(`div`,{className:g(`absolute right-0`,z?`bottom-14`:`bottom-16`,z?`w-[calc(100vw-24px)] max-w-72`:`w-72`,z?`max-h-[calc(100vh-70px)]`:`max-h-[calc(100vh-100px)]`,`overflow-hidden flex flex-col`,`bg-white rounded-2xl shadow-2xl border border-slate-200`,`transform transition-all duration-200 origin-bottom-right`,`animate-fade-in`),children:[(0,b.jsxs)(`div`,{className:`flex items-center justify-between px-4 py-3 border-b border-slate-100`,children:[(0,b.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,b.jsx)(p,{className:`w-5 h-5 text-orange-500`}),(0,b.jsx)(`span`,{className:`text-sm font-semibold text-slate-800`,children:`Super Panel`})]}),(0,b.jsx)(`button`,{onClick:()=>O(!1),className:`p-1 rounded-lg hover:bg-slate-100 text-slate-400 hover:text-slate-600 transition-colors`,children:(0,b.jsx)(l,{className:`w-4 h-4`})})]}),(0,b.jsxs)(`div`,{className:`px-4 py-2 overflow-y-auto flex-1 min-h-0`,children:[(0,b.jsx)(S,{icon:(0,b.jsx)(n,{className:`w-4 h-4`}),label:e(`superPanel.language`,`语言`),children:(0,b.jsx)(`button`,{onClick:K,className:g(`px-3 py-1.5 text-xs font-medium rounded-lg transition-colors`,`bg-slate-100 hover:bg-slate-200 text-slate-700`),children:$?`中文`:`English`})}),(0,b.jsx)(S,{icon:(0,b.jsx)(a,{className:`w-4 h-4`}),label:e(`superPanel.user`,`用户`),children:d?(0,b.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,b.jsx)(`span`,{className:`text-xs text-slate-500 max-w-[80px] truncate`,children:h}),(0,b.jsx)(`button`,{onClick:Q,className:g(`p-1.5 rounded-lg transition-colors`,`bg-red-50 hover:bg-red-100 text-red-600`),title:e(`auth.logout`),children:(0,b.jsx)(t,{className:`w-4 h-4`})})]}):(0,b.jsxs)(`button`,{onClick:()=>A(!0),className:g(`flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-colors`,`bg-blue-50 hover:bg-blue-100 text-blue-600`),children:[(0,b.jsx)(r,{className:`w-3.5 h-3.5`}),e(`auth.login`)]})}),(0,b.jsx)(S,{icon:(0,b.jsx)(o,{className:`w-4 h-4`}),label:$?`Console`:`控制台`,children:(0,b.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,b.jsxs)(`span`,{className:`text-[10px] text-slate-400`,children:[F.length,` `,$?`logs`:`条日志`]}),(0,b.jsx)(`button`,{onClick:J,className:`p-1 rounded hover:bg-slate-100 text-slate-400 hover:text-slate-600`,title:$?`Clear logs`:`清空日志`,disabled:F.length===0,children:(0,b.jsx)(s,{className:`w-3 h-3`})}),(0,b.jsx)(x,{enabled:L,onChange:q,size:`sm`})]})}),(0,b.jsx)(S,{icon:(0,b.jsx)(f,{className:`w-4 h-4`}),label:$?`Reload`:`重新加载`,children:(0,b.jsx)(`button`,{onClick:Y,className:g(`px-3 py-1.5 text-xs font-medium rounded-lg transition-colors`,`bg-blue-50 hover:bg-blue-100 text-blue-600`),children:$?`Reload Page`:`重载页面`})}),(0,b.jsx)(S,{icon:(0,b.jsx)(i,{className:`w-4 h-4`}),label:$?`Storage`:`存储`,children:(0,b.jsx)(`button`,{onClick:X,className:g(`px-3 py-1.5 text-xs font-medium rounded-lg transition-colors`,`bg-red-50 hover:bg-red-100 text-red-600`),children:$?`Clear All`:`清空全部`})})]}),L&&(0,b.jsxs)(`div`,{className:`border-t border-slate-100 flex-shrink-0`,children:[(0,b.jsx)(`div`,{className:`px-4 py-2 bg-slate-50`,children:(0,b.jsxs)(`div`,{className:`flex items-center justify-between mb-2`,children:[(0,b.jsx)(`span`,{className:`text-xs font-medium text-slate-600`,children:$?`Console Logs`:`控制台日志`}),(0,b.jsx)(`span`,{className:`text-[10px] text-slate-400`,children:$?`Latest 100`:`最新 100 条`})]})}),(0,b.jsx)(`div`,{className:g(`overflow-y-auto bg-slate-900 text-green-400 font-mono text-[10px]`,z?`max-h-32`:`max-h-48`),children:F.length===0?(0,b.jsx)(`div`,{className:`p-3 text-slate-500 text-center`,children:$?`No logs`:`暂无日志`}):F.map(e=>(0,b.jsx)(`div`,{className:g(`px-3 py-1 border-b border-slate-800`,e.level===`error`&&`text-red-400`,e.level===`warn`&&`text-yellow-400`,e.level===`info`&&`text-blue-400`,e.level===`log`&&`text-green-400`),children:(0,b.jsxs)(`div`,{className:`flex items-start gap-2`,children:[(0,b.jsxs)(`span`,{className:`text-slate-500 shrink-0`,children:[`[`,e.timestamp,`]`]}),(0,b.jsxs)(`span`,{className:`text-slate-400 shrink-0 uppercase`,children:[e.level,`:`]}),(0,b.jsxs)(`div`,{className:`flex-1`,children:[(0,b.jsx)(`span`,{className:`break-all whitespace-pre-wrap`,children:e.message}),e.count>1&&(0,b.jsxs)(`div`,{className:`mt-1 flex items-center gap-2`,children:[(0,b.jsxs)(`span`,{className:`inline-flex items-center px-1.5 py-0.5 rounded text-[8px] font-medium bg-orange-500 text-white`,children:[`× `,e.count]}),(0,b.jsxs)(`span`,{className:`text-[8px] text-slate-400`,children:[e.firstTimestamp,` - `,e.lastTimestamp]})]})]})]})},e.id))})]}),(0,b.jsx)(`div`,{className:`px-4 py-2 bg-slate-50 rounded-b-2xl`,children:(0,b.jsx)(`p`,{className:`text-[10px] text-slate-400 text-center`,children:`Test Environment Only`})})]}),(0,b.jsx)(`button`,{onClick:()=>O(!D),className:g(`rounded-full shadow-lg`,`flex items-center justify-center`,`transition-all duration-200 transform`,`hover:scale-110 active:scale-95`,z?`w-11 h-11`:`w-14 h-14`,D?`bg-orange-500 text-white rotate-90`:`bg-white text-orange-500 border border-slate-200`),"aria-label":`Open Super Panel`,children:(0,b.jsx)(p,{className:g(z?`w-5 h-5`:`w-6 h-6`)})})]}),(0,b.jsx)(v,{isOpen:k,onClose:()=>{A(!1),P(null)},onLogin:Z,isLoading:j,error:N})]})}const T=d(w);export{T as SuperPanel};