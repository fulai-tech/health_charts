import{C as e,E as t,O as n,T as r,at as i,h as a,r as o,rt as s,u as c}from"./vendor-DxyDeVV0.js";import"./vendor-charts-B__IZl80.js";import"./vendor-router-DvVHskPP.js";import"./vendor-query-BzUZE9-d.js";import{n as l}from"./vendor-i18n-BSzAmJZ7.js";import{c as u,l as d,o as f}from"./theme-XEO8amRP.js";import{t as p}from"./card-DR_iUne-.js";import{n as m,t as h}from"./useUrlParams-CgNyaJcn.js";import"./client-CzSh7g6B.js";import{t as g}from"./DistributionCard-D_3pQ4Tr.js";import"./useChartAnimation-DiAB65-P.js";import{t as _}from"./TrendLineChart-B7CWIoTy.js";import{t as v}from"./WeeklyOverviewCard-DICJkH00.js";import"./usePrefetchData-Dtc8Q6b7.js";import{n as y,t as b}from"./api-B7Y8ZWSI.js";import{t as x}from"./DisclaimerBox-CmM1idpz.js";var S=i(),C=s(),w=(0,S.memo)(({active:e,payload:t,label:n})=>{if(!e||!t||t.length===0)return null;let r=t.find(e=>e.dataKey===`systolic`&&e.name===`systolic`),i=t.find(e=>e.dataKey===`diastolic`&&e.name===`diastolic`);return(0,C.jsxs)(`div`,{className:`bg-slate-700 text-white px-3 py-2 rounded-lg text-sm shadow-lg`,children:[(0,C.jsx)(`p`,{className:`font-medium mb-1`,children:n}),r&&(0,C.jsxs)(`p`,{className:`text-orange-300`,children:[`SBP: `,r.value]}),i&&(0,C.jsxs)(`p`,{className:`text-emerald-300`,children:[`DBP: `,i.value]})]})});const T=(0,S.memo)(({data:e,className:t,isLoading:n})=>{var r,i,a,s;let{t:f}=l(),m=d.bp,h=[{name:`Mon`,systolic:120,diastolic:80},{name:`Tues`,systolic:118,diastolic:78},{name:`Wed`,systolic:122,diastolic:82},{name:`Thu`,systolic:119,diastolic:79},{name:`Fri`,systolic:121,diastolic:81},{name:`Sat`,systolic:117,diastolic:77},{name:`Sun`,systolic:120,diastolic:80}],g=(0,S.useMemo)(()=>{var t,n;return(t=e==null||(n=e.chartData)==null?void 0:n.map((e,t)=>({name:[`Mon`,`Tues`,`Wed`,`Thu`,`Fri`,`Sat`,`Sun`][t%7],systolic:e.systolic,diastolic:e.diastolic})))==null?h:t},[e==null?void 0:e.chartData]);return(0,C.jsxs)(p,{className:`${t} relative`,children:[(0,C.jsx)(`div`,{className:`absolute inset-0 rounded-2xl flex items-center justify-center z-10 transition-all duration-300 ease-in-out ${n?`opacity-100`:`opacity-0 pointer-events-none`}`,style:{backgroundColor:u.loadingOverlay},children:(0,C.jsx)(c,{className:`w-8 h-8 text-white animate-spin`})}),(0,C.jsxs)(`div`,{className:`flex items-center justify-between mb-4`,children:[(0,C.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,C.jsx)(o,{className:`w-5 h-5`,style:{color:m}}),(0,C.jsx)(`h3`,{className:`text-base font-semibold text-slate-800`,children:f(`page.bloodPressure.trendyReport`)})]}),n&&(0,C.jsxs)(`div`,{className:`flex items-center gap-1.5 text-xs text-slate-400`,children:[(0,C.jsx)(c,{className:`w-3 h-3 animate-spin`}),(0,C.jsx)(`span`,{children:f(`common.loading`)})]})]}),(0,C.jsxs)(`div`,{className:`flex gap-3 mb-5`,children:[(0,C.jsxs)(`div`,{className:`flex-1 p-3 rounded-xl bg-orange-50`,children:[(0,C.jsxs)(`div`,{className:`flex items-baseline gap-1`,children:[(0,C.jsx)(`span`,{className:`text-2xl font-bold`,style:{color:m},children:(r=e==null||(i=e.summary)==null?void 0:i.avgSystolic)==null?`--`:r}),(0,C.jsx)(`span`,{className:`text-sm text-slate-500`,children:f(`units.mmHg`)})]}),(0,C.jsx)(`p`,{className:`text-xs text-slate-500 mt-1`,children:f(`page.bloodPressure.weeksAverageSBP`)})]}),(0,C.jsxs)(`div`,{className:`flex-1 p-3 rounded-xl bg-orange-50`,children:[(0,C.jsxs)(`div`,{className:`flex items-baseline gap-1`,children:[(0,C.jsx)(`span`,{className:`text-2xl font-bold`,style:{color:m},children:(a=e==null||(s=e.summary)==null?void 0:s.avgDiastolic)==null?`--`:a}),(0,C.jsx)(`span`,{className:`text-sm text-slate-500`,children:f(`units.mmHg`)})]}),(0,C.jsx)(`p`,{className:`text-xs text-slate-500 mt-1`,children:f(`page.bloodPressure.weeksAverageDBP`)})]})]}),(0,C.jsx)(_,{data:g,lines:[{dataKey:`systolic`,color:m,label:f(`vitals.sbp`),showArea:!0,gradientId:`sbpGradient`,legendShape:`circle`},{dataKey:`diastolic`,color:`#10B981`,label:f(`vitals.dbp`),showArea:!0,gradientId:`dbpGradient`,legendShape:`circle`}],xAxisKey:`name`,yAxisDomain:[50,150],renderTooltip:e=>(0,C.jsx)(w,{...e}),height:224})]})});var E={normal:`status.normal`,high_normal:`status.normalHighValue`,low_bp:`status.tooLow`,high_bp:`status.tooHigh`},D=[`normal`,`high_normal`,`low_bp`,`high_bp`];const O=(0,S.memo)(({data:e,className:t,isLoading:r})=>{var i,a,o,s;let{t:c}=l(),u=d.bp,p=(i=e==null||(a=e.summary)==null?void 0:a.distribution)==null?[]:i,m=(o=e==null||(s=e.summary)==null?void 0:s.totalCount)==null?0:o,h=(0,S.useMemo)(()=>D.map(e=>{let t=p.find(t=>t.type===e);return{type:e,label:c(E[e]),count:(t==null?void 0:t.count)||0,percent:(t==null?void 0:t.percent)||0,color:f.bp[e]||`#94A3B8`}}),[p,c]),_=(0,S.useMemo)(()=>h.filter(e=>e.type===`normal`||e.type===`high_normal`).reduce((e,t)=>e+(t.count||0),0),[h]),v=(0,S.useMemo)(()=>c(`page.bloodPressure.bpClassification`),[c]);return(0,C.jsx)(g,{title:c(`page.bloodPressure.bpStatistics`),icon:n,themeColor:u,pieChartSize:`medium`,items:h,centerValue:c(`common.good`),centerLabel:c(`common.inAverage`),highlightValue:_,highlightLabel:`/ ${m} ${c(`common.times`)}`,highlightDescription:c(`page.bloodPressure.normalResults`),gridColumns:2,infoContent:v,className:t,isLoading:r})}),k=(0,S.memo)(({data:n,className:i,isLoading:a})=>{var o,s;let{t:f}=l(),m=d.bp,h=(o=n==null?void 0:n.comparison)==null?{current:{systolic:0,diastolic:0},previous:{systolic:0,diastolic:0},insight:null}:o,g=(s=n==null?void 0:n.summary)==null?{systolicChange:0,diastolicChange:0,systolicTrend:`stable`,diastolicTrend:`stable`}:s,_=(0,S.useMemo)(()=>e=>e===`up`?(0,C.jsx)(r,{className:`w-4 h-4`}):e===`down`?(0,C.jsx)(t,{className:`w-4 h-4`}):null,[]),v=(0,S.useMemo)(()=>h.insight||f(`page.bloodPressure.defaultInsight`,{defaultValue:`Your blood pressure is generally within the ideal range. Although your systolic blood pressure has risen slightly compared to last week, it remains within the normal fluctuation range.`}),[h.insight,f]);return(0,C.jsxs)(p,{className:`${i} relative overflow-hidden`,children:[(0,C.jsx)(`div`,{className:`absolute inset-0 rounded-2xl flex items-center justify-center z-10 transition-all duration-300 ease-in-out ${a?`opacity-100`:`opacity-0 pointer-events-none`}`,style:{backgroundColor:u.loadingOverlay},children:(0,C.jsx)(c,{className:`w-8 h-8 text-white animate-spin`})}),(0,C.jsxs)(`div`,{className:`flex items-center gap-2 mb-4`,children:[(0,C.jsx)(e,{className:`w-5 h-5`,style:{color:m}}),(0,C.jsx)(`h3`,{className:`text-base font-semibold text-slate-800`,children:f(`page.bloodPressure.compareWithLastWeek`)})]}),(0,C.jsxs)(`div`,{className:`flex gap-3 mb-4`,children:[(0,C.jsxs)(`div`,{className:`flex-1 p-3 rounded-xl bg-slate-50`,children:[(0,C.jsx)(`p`,{className:`text-xs text-slate-500 mb-1`,children:f(`page.bloodPressure.averageSBP`)}),(0,C.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,C.jsx)(`span`,{className:`text-xl font-bold`,style:{color:m},children:n?h.current.systolic:`--`}),(0,C.jsx)(`span`,{className:`text-sm text-slate-400`,children:f(`units.mmHg`)}),g.systolicChange!==0&&(0,C.jsxs)(`div`,{className:`flex items-center gap-0.5 text-sm font-medium`,style:{color:m},children:[_(g.systolicTrend),Math.abs(g.systolicChange)]})]}),(0,C.jsxs)(`p`,{className:`text-xs text-slate-400 mt-1`,children:[f(`time.lastWeek`),`: `,n?h.previous.systolic:`--`,f(`units.mmHg`)]})]}),(0,C.jsxs)(`div`,{className:`flex-1 p-3 rounded-xl bg-slate-50`,children:[(0,C.jsx)(`p`,{className:`text-xs text-slate-500 mb-1`,children:f(`page.bloodPressure.averageDBP`)}),(0,C.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,C.jsx)(`span`,{className:`text-xl font-bold`,style:{color:m},children:n?h.current.diastolic:`--`}),(0,C.jsx)(`span`,{className:`text-sm text-slate-400`,children:f(`units.mmHg`)}),g.diastolicChange!==0&&(0,C.jsxs)(`div`,{className:`flex items-center gap-0.5 text-sm font-medium`,style:{color:m},children:[_(g.diastolicTrend),Math.abs(g.diastolicChange)]})]}),(0,C.jsxs)(`p`,{className:`text-xs text-slate-400 mt-1`,children:[f(`time.lastWeek`),`: `,n?h.previous.diastolic:`--`,f(`units.mmHg`)]})]})]}),(0,C.jsx)(`div`,{className:`p-4 rounded-2xl bg-sky-50`,children:(0,C.jsx)(`p`,{className:`text-sm text-slate-700 leading-relaxed`,children:v})})]})}),A=(0,S.memo)(({data:e,weeklySummary:t,className:n,isLoading:r})=>{let{t:i}=l(),o=d.bp;return(0,C.jsx)(v,{titleKey:`page.bloodPressure.weeklyOverview`,Icon:a,overallText:(0,S.useMemo)(()=>(t==null?void 0:t.overview)||i(`page.bloodPressure.defaultOverview`,{defaultValue:`Your blood pressure is generally within the ideal range. Although your systolic blood pressure has risen slightly compared to last week, it remains within the normal fluctuation range.`}),[t==null?void 0:t.overview,i]),highlightText:(0,S.useMemo)(()=>(t==null?void 0:t.highlights)||i(`page.bloodPressure.defaultHighlights`,{defaultValue:`The trend chart shows that your blood pressure rose significantly during the week (Wednesday and Thursday), with a peak systolic pressure approaching 150 mmHg. Meanwhile, the statistics show that your blood pressure measurements fluctuated considerably across different levels. We will continue to monitor your condition and help you identify any possible causes for the elevated blood pressure.`}),[t==null?void 0:t.highlights,i]),highlightLabelKey:`page.bloodPressure.needsAttention`,highlightColor:`#FBBF24`,suggestions:t==null?void 0:t.suggestions,themeColor:o,className:n,isLoading:r})});function j(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,`0`)}-${String(e.getDate()).padStart(2,`0`)}`}function M(e){return`${e.getFullYear()}/${String(e.getMonth()+1).padStart(2,`0`)}/${String(e.getDate()).padStart(2,`0`)}`}function N(){let{t:e}=l(),{theme:t}=h(),{prefetchPreviousWeeks:n}=y(),[r,i]=(0,S.useState)(()=>{let e=new Date,t=new Date;return t.setDate(e.getDate()-6),{start:t,end:e}});(0,S.useEffect)(()=>{n(r.end,3)},[r.end,n]);let a=(0,S.useMemo)(()=>{let e=new Date;e.setHours(0,0,0,0);let t=new Date(r.end);return t.setHours(0,0,0,0),t<e},[r.end]),o=(0,S.useMemo)(()=>({startDate:j(r.start),endDate:j(r.end)}),[r]),s=(0,S.useMemo)(()=>({start:M(r.start),end:M(r.end)}),[r]),c=()=>{i(e=>{let t=new Date(e.start),n=new Date(e.end);return t.setDate(t.getDate()-7),n.setDate(n.getDate()-7),{start:t,end:n}})},u=()=>{a&&i(e=>{let t=new Date(e.start),n=new Date(e.end);t.setDate(t.getDate()+7),n.setDate(n.getDate()+7);let r=new Date;return n>r&&(n.setTime(r.getTime()),t.setTime(r.getTime()),t.setDate(t.getDate()-6)),{start:t,end:n}})},{data:d,isLoading:f,isFetching:p,error:g}=b(o);return g?(0,C.jsx)(`div`,{className:`min-h-screen flex items-center justify-center p-4`,style:{backgroundColor:t.background},children:(0,C.jsxs)(`div`,{className:`text-center`,children:[(0,C.jsx)(`p`,{className:`text-red-500 mb-2`,children:e(`common.error`)}),(0,C.jsx)(`p`,{className:`text-sm`,style:{color:t.textSecondary},children:String(g)})]})}):(0,C.jsx)(`div`,{className:`min-h-screen pb-20`,style:{backgroundColor:t.background},children:(0,C.jsxs)(`div`,{className:`max-w-2xl mx-auto`,children:[(0,C.jsx)(`div`,{className:`sticky top-0 z-20 py-3 px-4`,style:{backgroundColor:t.background},children:(0,C.jsx)(`div`,{className:`flex justify-center`,children:(0,C.jsx)(m,{startDate:s.start,endDate:s.end,onPrevious:c,onNext:u,disableNext:!a})})}),(0,C.jsx)(`div`,{className:`px-4 space-y-4`,children:!d&&!f?(0,C.jsx)(`div`,{className:`flex items-center justify-center py-20`,children:(0,C.jsx)(`p`,{style:{color:t.textSecondary},children:e(`common.noData`)})}):(0,C.jsxs)(`div`,{className:`space-y-4`,children:[(0,C.jsx)(T,{data:d}),(0,C.jsx)(O,{data:d}),(0,C.jsx)(k,{data:d}),(0,C.jsx)(A,{data:d}),(0,C.jsx)(x,{})]})})]})})}export{N as BloodPressurePage};