import{At as e}from"./vendor-kaGLFeG7.js";import"./vendor-charts-BuUdTzGu.js";import{C as t,L as n,O as r,W as i,at as a,d as o,g as s,h as c,k as l,l as u,t as d,ut as f,x as p,y as m,z as h}from"./vendor-react-CChzBFJ2.js";import{a as g,i as _,n as ee,o as te,r as v,s as y,t as b}from"./index-BRJ8ltP-.js";var x=e(),S=f();function C({enabled:e,onChange:t,size:n=`md`}){let r=n===`sm`?`h-5 w-9`:`h-6 w-11`,i=n===`sm`?`h-3 w-3`:`h-4 w-4`,a=n===`sm`?e?`translate-x-5`:`translate-x-1`:e?`translate-x-6`:`translate-x-1`;return(0,S.jsx)(`button`,{onClick:()=>t(!e),className:y(`relative inline-flex items-center rounded-full transition-colors`,`focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2`,r,e?`bg-orange-500`:`bg-slate-300`),role:`switch`,"aria-checked":e,children:(0,S.jsx)(`span`,{className:y(`inline-block transform rounded-full bg-white transition-transform`,i,a)})})}function w({icon:e,label:t,children:n}){return(0,S.jsxs)(`div`,{className:`flex items-center justify-between py-3 border-b border-slate-100 last:border-b-0`,children:[(0,S.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,S.jsx)(`div`,{className:`w-8 h-8 rounded-lg bg-slate-100 flex items-center justify-center text-slate-600`,children:e}),(0,S.jsx)(`span`,{className:`text-sm font-medium text-slate-700`,children:t})]}),(0,S.jsx)(`div`,{className:`flex items-center gap-2`,children:n})]})}var T=100,E=`super_panel_pinned`;function D(){try{return localStorage.getItem(E)===`true`}catch(e){return!1}}function O(){let{t:e,i18n:d}=a(),{isAuthenticated:f,username:te,logout:O}=v(),{language:k,setLanguage:ne}=_(),{isTestEnv:A,setIsTestEnv:re}=g(),[j,M]=(0,x.useState)(()=>D()),[N,P]=(0,x.useState)(()=>D()),[F,I]=(0,x.useState)(!1),[L,R]=(0,x.useState)(!1),[z,B]=(0,x.useState)(null),[V,H]=(0,x.useState)([]),[U,W]=(0,x.useState)(!1),[G,K]=(0,x.useState)(!1),q=(0,x.useRef)(null),J=(0,x.useRef)(0),Y=(0,x.useRef)(!1),X=(0,x.useRef)([]),Z=(0,x.useRef)(null);(0,x.useEffect)(()=>{let e=()=>{K(window.innerWidth<360||window.innerHeight<500)};return e(),window.addEventListener(`resize`,e),()=>window.removeEventListener(`resize`,e)},[]),(0,x.useEffect)(()=>{let e={log:console.log,warn:console.warn,error:console.error,info:console.info};Z.current=e;let t=(e,t)=>{J.current+=1;let n=new Date().toLocaleTimeString(),r=t.map(e=>{if(typeof e==`object`&&e)try{let t=JSON.stringify(e,null,2);return t.length>2e3?t.slice(0,2e3)+`... (truncated)`:t}catch(e){return`[Circular/Unserializable Object]`}return String(e)}).join(` `);return{id:J.current,timestamp:n,level:e,message:r,args:t,count:1,firstTimestamp:n,lastTimestamp:n}},n=setInterval(()=>{X.current.length!==0&&H(e=>{let t=[...e],n=[...X.current];return X.current=[],n.forEach(e=>{let n=t[t.length-1];n&&n.level===e.level&&n.message===e.message?t[t.length-1]={...n,count:n.count+1,lastTimestamp:e.timestamp,timestamp:e.timestamp}:t.push(e)}),t.length>T&&(t=t.slice(-T)),t})},500),r=n=>(...r)=>{if(e[n].apply(console,r),!Y.current)try{Y.current=!0;let e=r.join(` `);if(e.includes(`i18next::translator: missingKey`)||e.includes(`SuperPanel`)&&e.includes(`translation`))return;let i=t(n,r);X.current.push(i)}catch(e){}finally{Y.current=!1}};return console.log=r(`log`),console.warn=r(`warn`),console.error=r(`error`),console.info=r(`info`),()=>{console.log=e.log,console.warn=e.warn,console.error=e.error,console.info=e.info,clearInterval(n)}},[]),(0,x.useEffect)(()=>{let e=e=>{N||q.current&&!q.current.contains(e.target)&&M(!1)};return j&&!N&&document.addEventListener(`mousedown`,e),()=>document.removeEventListener(`mousedown`,e)},[j,N]);let ie=()=>{let e=!N;P(e);try{localStorage.setItem(E,String(e))}catch(e){}},ae=()=>{let e=d.language.startsWith(`en`)?`zh`:`en`;d.changeLanguage(e),ne(e)},oe=()=>{W(!U)},se=()=>{H([])},Q=()=>{window.location.reload()},ce=()=>{try{localStorage.clear(),sessionStorage.clear(),document.cookie.split(`;`).forEach(e=>{let t=e.indexOf(`=`),n=t>-1?e.substr(0,t).trim():e.trim();document.cookie=`${n}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/`,document.cookie=`${n}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=${window.location.hostname}`,document.cookie=`${n}=;expires=Thu, 01 Jan 1970 00:00:00 GMT;path=/;domain=.${window.location.hostname}`}),`indexedDB`in window&&indexedDB.databases().then(e=>{e.forEach(e=>{e.name&&indexedDB.deleteDatabase(e.name)})}).catch(()=>{}),alert($?`All storage cleared! Page will reload.`:`所有存储已清空！页面即将重新加载。`),window.location.reload()}catch(n){var e,t;!((e=Z.current)==null||(t=e.error)==null)&&t.call(e,`Clear storage failed:`,n)||console.error(`Clear storage failed:`,n),alert($?`Failed to clear storage completely`:`清空存储失败`)}},le=async(t,n)=>{R(!0),B(null);try{await ee.login({username:t,password:n}),I(!1)}catch(t){var r,i;!((r=Z.current)==null||(i=r.error)==null)&&i.call(r,`Login failed:`,t)||console.error(`Login failed:`,t),B(t instanceof Error?t.message:e(`auth.loginFailed`))}finally{R(!1)}},ue=()=>{O()},$=d.language.startsWith(`en`);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(`div`,{ref:q,className:y(`fixed z-[9999]`,G?`bottom-3 right-3`:`bottom-6 right-6`),children:[j&&(0,S.jsxs)(`div`,{className:y(`absolute right-0`,G?`bottom-14`:`bottom-16`,G?`w-[calc(100vw-24px)] max-w-72`:`w-72`,G?`max-h-[calc(100vh-70px)]`:`max-h-[calc(100vh-100px)]`,`overflow-hidden flex flex-col`,`bg-white rounded-2xl shadow-2xl border border-slate-200`,`transform transition-all duration-200 origin-bottom-right`,`animate-fade-in`),children:[(0,S.jsxs)(`div`,{className:`flex items-center justify-between px-4 py-3 border-b border-slate-100`,children:[(0,S.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,S.jsx)(m,{className:`w-5 h-5 text-orange-500`}),(0,S.jsx)(`span`,{className:`text-sm font-semibold text-slate-800`,children:`Super Panel`})]}),(0,S.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,S.jsx)(`button`,{onClick:ie,className:y(`p-1 rounded-lg transition-colors`,N?`bg-orange-100 text-orange-500`:`hover:bg-slate-100 text-slate-400 hover:text-slate-600`),title:N?$?`Unpin`:`取消固定`:$?`Pin`:`固定`,children:(0,S.jsx)(t,{className:y(`w-4 h-4`,N&&`rotate-45`)})}),(0,S.jsx)(`button`,{onClick:()=>M(!1),className:`p-1 rounded-lg hover:bg-slate-100 text-slate-400 hover:text-slate-600 transition-colors`,children:(0,S.jsx)(u,{className:`w-4 h-4`})})]})]}),(0,S.jsxs)(`div`,{className:`px-4 py-2 overflow-y-auto flex-1 min-h-0`,children:[(0,S.jsx)(w,{icon:(0,S.jsx)(h,{className:`w-4 h-4`}),label:$?`Test Mode`:`测试模式`,children:(0,S.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,S.jsx)(`span`,{className:`text-[10px] text-slate-400`,children:A?$?`ON`:`开`:$?`OFF`:`关`}),(0,S.jsx)(C,{enabled:A,onChange:re,size:`sm`})]})}),(0,S.jsx)(w,{icon:(0,S.jsx)(n,{className:`w-4 h-4`}),label:e(`superPanel.language`,`语言`),children:(0,S.jsx)(`button`,{onClick:ae,className:y(`px-3 py-1.5 text-xs font-medium rounded-lg transition-colors`,`bg-slate-100 hover:bg-slate-200 text-slate-700`),children:$?`中文`:`English`})}),(0,S.jsx)(w,{icon:(0,S.jsx)(o,{className:`w-4 h-4`}),label:e(`superPanel.user`,`用户`),children:f?(0,S.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,S.jsx)(`span`,{className:`text-xs text-slate-500 max-w-[80px] truncate`,children:te}),(0,S.jsx)(`button`,{onClick:ue,className:y(`p-1.5 rounded-lg transition-colors`,`bg-red-50 hover:bg-red-100 text-red-600`),title:e(`auth.logout`),children:(0,S.jsx)(r,{className:`w-4 h-4`})})]}):(0,S.jsxs)(`button`,{onClick:()=>I(!0),className:y(`flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg transition-colors`,`bg-blue-50 hover:bg-blue-100 text-blue-600`),children:[(0,S.jsx)(l,{className:`w-3.5 h-3.5`}),e(`auth.login`)]})}),(0,S.jsx)(w,{icon:(0,S.jsx)(s,{className:`w-4 h-4`}),label:$?`Console`:`控制台`,children:(0,S.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,S.jsxs)(`span`,{className:`text-[10px] text-slate-400`,children:[V.length,` `,$?`logs`:`条日志`]}),(0,S.jsx)(`button`,{onClick:se,className:`p-1 rounded hover:bg-slate-100 text-slate-400 hover:text-slate-600`,title:$?`Clear logs`:`清空日志`,disabled:V.length===0,children:(0,S.jsx)(c,{className:`w-3 h-3`})}),(0,S.jsx)(C,{enabled:U,onChange:oe,size:`sm`})]})}),(0,S.jsx)(w,{icon:(0,S.jsx)(p,{className:`w-4 h-4`}),label:$?`Reload`:`重新加载`,children:(0,S.jsx)(`button`,{onClick:Q,className:y(`px-3 py-1.5 text-xs font-medium rounded-lg transition-colors`,`bg-blue-50 hover:bg-blue-100 text-blue-600`),children:$?`Reload Page`:`重载页面`})}),(0,S.jsx)(w,{icon:(0,S.jsx)(i,{className:`w-4 h-4`}),label:$?`Storage`:`存储`,children:(0,S.jsx)(`button`,{onClick:ce,className:y(`px-3 py-1.5 text-xs font-medium rounded-lg transition-colors`,`bg-red-50 hover:bg-red-100 text-red-600`),children:$?`Clear All`:`清空全部`})})]}),U&&(0,S.jsxs)(`div`,{className:`border-t border-slate-100 flex-shrink-0`,children:[(0,S.jsx)(`div`,{className:`px-4 py-2 bg-slate-50`,children:(0,S.jsxs)(`div`,{className:`flex items-center justify-between mb-2`,children:[(0,S.jsx)(`span`,{className:`text-xs font-medium text-slate-600`,children:$?`Console Logs`:`控制台日志`}),(0,S.jsx)(`span`,{className:`text-[10px] text-slate-400`,children:$?`Latest 100`:`最新 100 条`})]})}),(0,S.jsx)(`div`,{className:y(`overflow-y-auto bg-slate-900 text-green-400 font-mono text-[10px]`,G?`max-h-32`:`max-h-48`),children:V.length===0?(0,S.jsx)(`div`,{className:`p-3 text-slate-500 text-center`,children:$?`No logs`:`暂无日志`}):V.map(e=>(0,S.jsx)(`div`,{className:y(`px-3 py-1 border-b border-slate-800`,e.level===`error`&&`text-red-400`,e.level===`warn`&&`text-yellow-400`,e.level===`info`&&`text-blue-400`,e.level===`log`&&`text-green-400`),children:(0,S.jsxs)(`div`,{className:`flex items-start gap-2`,children:[(0,S.jsxs)(`span`,{className:`text-slate-500 shrink-0`,children:[`[`,e.timestamp,`]`]}),(0,S.jsxs)(`span`,{className:`text-slate-400 shrink-0 uppercase`,children:[e.level,`:`]}),(0,S.jsxs)(`div`,{className:`flex-1`,children:[(0,S.jsx)(`span`,{className:`break-all whitespace-pre-wrap`,children:e.message}),e.count>1&&(0,S.jsxs)(`div`,{className:`mt-1 flex items-center gap-2`,children:[(0,S.jsxs)(`span`,{className:`inline-flex items-center px-1.5 py-0.5 rounded text-[8px] font-medium bg-orange-500 text-white`,children:[`× `,e.count]}),(0,S.jsxs)(`span`,{className:`text-[8px] text-slate-400`,children:[e.firstTimestamp,` - `,e.lastTimestamp]})]})]})]})},e.id))})]}),(0,S.jsx)(`div`,{className:`px-4 py-2 bg-slate-50 rounded-b-2xl`,children:(0,S.jsx)(`p`,{className:`text-[10px] text-slate-400 text-center`,children:`Test Environment Only`})})]}),(0,S.jsx)(`button`,{onClick:()=>M(!j),className:y(`rounded-full shadow-lg`,`flex items-center justify-center`,`transition-all duration-200 transform`,`hover:scale-110 active:scale-95`,G?`w-11 h-11`:`w-14 h-14`,j?`bg-orange-500 text-white rotate-90`:`bg-white text-orange-500 border border-slate-200`),"aria-label":`Open Super Panel`,children:(0,S.jsx)(m,{className:y(G?`w-5 h-5`:`w-6 h-6`)})})]}),(0,S.jsx)(b,{isOpen:F,onClose:()=>{I(!1),B(null)},onLogin:le,isLoading:L,error:z})]})}const k=d(O);export{k as SuperPanel};